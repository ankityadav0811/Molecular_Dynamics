LAMMPS (22 Jul 2025)
  using 1 OpenMP thread(s) per MPI task
# Compute elastic constant tensor for a crystal at finite temperature
#
# WARNING: This script attempts to measure small differences in
# statistical averages generated by finite temperature MD simulations.
# This creates many more opportunities for errors to occur, compared
# to the zero temperature version provided in examples/ELASTIC.
# Hence, it is always a good idea to start with the zero temperature
# calculation, before attempting to use this script.
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, MD parameters, deformation parameters,
#		  and initial configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the MD sampling of stress components
#  is generating accurate statistical averages.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to
#  check for finite size effects.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 1.0e-2

# metal units, elastic constants in GPa
units		metal
variable cfac equal 1.0e-4
variable cunits string GPa

# Define MD parameters
variable nevery equal 400                  # sampling interval
variable nrepeat equal 400                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 400*${nrepeat} 
variable nfreq equal 400*400 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 160000           
variable nequil equal 10*${nthermo}       # length of equilibration run
variable nequil equal 10*160000       
variable nrun equal 3*${nthermo}          # length of equilibrated run
variable nrun equal 3*160000          
variable temp equal 300.0                # temperature of initial sample
variable timestep equal 0.001             # timestep
variable mass1 equal 26.981539              # mass
variable adiabatic equal 0                # adiabatic (1) or isothermal (2)
variable tdamp equal 0.01                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable pdamp equal 0.1
# generate the box and atom positions using a fcc lattice
variable a equal 4.05

boundary        p p p


lattice        fcc $a
lattice        fcc 4.05
Lattice spacing in x,y,z = 4.05 4.05 4.05
region         box prism 0 10.0 0 10.0 0 10.0 0.0 0.0 0.0
create_box     1 box
Created triclinic box = (0 0 0) to (40.5 40.5 40.5) with tilt (0 0 0)
  2 by 4 by 5 MPI processor grid
create_atoms   1 box
Created 4000 atoms
  using lattice units in triclinic box = (0 0 0) to (40.5 40.5 40.5) with tilt (0 0 0)
  create_atoms CPU = 0.013 seconds

mass 1 ${mass1}
mass 1 26.981539
velocity        all create ${temp} 87287
velocity        all create 300 87287


# Compute initial state

variable thermostat equal 1
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.961 | 3.964 | 3.968 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   299.99999     -14974.89      -2903.9736      0              0              0              0              0              0            
    160000   299.10829     -14820.256      9895.6281      9958.0979      9962.4588      9975.4597      8.2124778     -2.2361102      2.5533215    
    320000   291.45254     -14816.627      10103.139      9960.9931      9955.6485      9966.4834      2.3274805     -0.49643858     11.989089    
    480000   304.92646     -14820.438      9888.6617      9959.9998      9955.9784      9946.6784      18.229347      10.654894     -8.6022951    
    640000   305.45419     -14817.941      10102.156      9943.5518      9953.2817      9947.0045      2.2994839      17.364063      13.986064    
    800000   302.8842      -14819.18       9966.2921      9953.8238      9943.4964      9952.7753      2.340032      -6.1556446      22.930491    
    960000   300.10537     -14818.989      9954.2711      9953.9372      9969.3626      9967.6133      0.085741793    5.7856592      11.125407    
   1120000   302.42431     -14819.289      9961.1724      9963.8183      9979.2608      9965.5392      3.4160481      7.6650285      2.3116185    
   1280000   305.68918     -14820.443      9916.1793      9930.8174      9927.7898      9935.4511      3.3719565      6.6701778     -0.70527766   
   1440000   298.74421     -14821.479      9732.837       9953.2481      9960.9649      9963.9094      2.8261768      0.91437755    -6.1086123    
   1600000   305.33034     -14819.811      9960.028       9947.5746      9947.4095      9944.9915     -1.2964198     -9.5045874     -0.4673137    
Loop time of 3137.49 on 40 procs for 1600000 steps with 4000 atoms

Performance: 44.061 ns/day, 0.545 hours/ns, 509.962 timesteps/s, 2.040 Matom-step/s
99.2% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2992.1     | 3001.8     | 3013.5     |  11.5 | 95.67
Neigh   | 2.6383     | 2.6502     | 2.675      |   0.5 |  0.08
Comm    | 89.222     | 99.321     | 108.11     |  50.5 |  3.17
Output  | 0.00046564 | 0.00050069 | 0.00064497 |   0.0 |  0.00
Modify  | 8.0296     | 8.2456     | 8.655      |   4.4 |  0.26
Other   |            | 25.51      |            |       |  0.81

Nlocal:            100 ave         106 max          91 min
Histogram: 1 2 3 0 6 4 10 3 6 5
Nghost:        857.475 ave         870 max         845 min
Histogram: 3 2 6 4 3 2 11 4 3 2
Neighs:        2773.82 ave        2935 max        2548 min
Histogram: 2 3 2 1 7 3 6 8 3 5
FullNghs:      5547.65 ave        5860 max        5040 min
Histogram: 1 3 1 2 5 5 5 8 4 6

Total # of neighbors = 221906
Ave neighs/atom = 55.4765
Neighbor list builds = 11240
Dangerous builds = 0


fix 2  all npt temp ${temp} ${temp} ${tdamp} drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 ${temp} ${tdamp} drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 300 ${tdamp} drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 300 0.01 drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 300 0.01 drag 1.0 pchain 8 aniso 0.0 0.0 0.1
run ${nequil}
run 1600000
WARNING: One or more atoms are time integrated more than once
For more information see https://docs.lammps.org/err0032 (src/modify.cpp:298)
Per MPI rank memory allocation (min/avg/max) = 3.961 | 3.964 | 3.968 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
   1600000   305.33034     -14819.811      9960.028       9947.5746      9947.4095      9944.9915     -1.2964198     -9.5045874     -0.4673137    
   1760000   568.36534     -14651.946     -376.09142     -110.10598     -78.865698     -70.040232      10.23039      -0.075016125   -6.966087     
   1920000   571.73515     -14649.68       201.29584     -99.175806     -100.7631      -109.41022      12.147992      2.9780735     -12.431341    
   2080000   569.77475     -14650.583      37.070327     -58.196785     -86.140569     -54.002084      14.616364      8.3489064      14.647436    
   2240000   566.42109     -14654.064     -402.86629     -27.830574     -90.340098     -62.343244     -2.5244528      0.48400277    -6.2423184    
   2400000   572.76606     -14651.732      125.11078     -65.151915     -65.583543     -62.08066      -27.407482      1.486544      -12.929817    
   2560000   574.48248     -14653.433     -87.497202     -42.418668     -93.916479     -60.628002      0.57344374    -20.802182      11.30152     
   2720000   574.72048     -14647.735      411.54346     -84.741748     -140.13302     -99.139669     -11.550067      28.192566     -7.8431769    
   2880000   581.54347     -14643.556      522.58438     -40.342052     -53.281176     -94.161198     -5.536889       14.695261      3.1668131    
   3040000   573.16241     -14647.754     -359.51489     -111.81688     -102.24393     -112.58212     -6.7033675     -10.17312      -13.88936     
   3200000   582.58949     -14647.205      410.89487     -72.620065     -21.93065      -48.56568       21.933065     -7.6803101      20.016308    
Loop time of 3246.22 on 40 procs for 1600000 steps with 4000 atoms

Performance: 42.585 ns/day, 0.564 hours/ns, 492.880 timesteps/s, 1.972 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 3052.2     | 3060.6     | 3071       |  10.6 | 94.28
Neigh   | 15.692     | 15.747     | 15.919     |   1.1 |  0.49
Comm    | 86.547     | 95.267     | 101.77     |  43.4 |  2.93
Output  | 0.00041402 | 0.00045438 | 0.00058013 |   0.0 |  0.00
Modify  | 54.447     | 57.341     | 62.287     |  24.6 |  1.77
Other   |            | 17.27      |            |       |  0.53

Nlocal:            100 ave         104 max          97 min
Histogram: 2 5 6 0 14 8 0 2 2 1
Nghost:        788.025 ave         796 max         776 min
Histogram: 2 2 2 1 2 7 6 8 6 4
Neighs:        2780.85 ave        2938 max        2646 min
Histogram: 1 3 7 6 6 3 9 3 1 1
FullNghs:       5561.7 ave        5781 max        5390 min
Histogram: 4 2 5 6 6 8 4 2 2 1

Total # of neighbors = 222468
Ave neighs/atom = 55.617
Neighbor list builds = 69745
Dangerous builds = 0
unfix 2

if "${adiabatic} == 1" then "variable thermostat equal 0" else "variable thermostat equal 1"
variable thermostat equal 1

print ${thermostat}
print 1
1

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.961 | 3.964 | 3.968 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   582.58949     -14647.205      410.89487      0              0              0              0              0              0            
    160000   299.68236     -14791.195     -14694.354     -14656.156     -14310.459     -14795.608     -9.7943192     -11.116588      4.9905021    
    320000   302.2713      -14789.83      -14565.078     -14670.029     -14275.226     -14801.92       0.4787244     -8.5259019     -5.7865147    
    480000   302.3876      -14790.274     -14569.027     -14661.413     -14292.547     -14799.87      -3.8260335     -10.989582     -5.8847537    
Loop time of 892.938 on 40 procs for 480000 steps with 4000 atoms

Performance: 46.444 ns/day, 0.517 hours/ns, 537.551 timesteps/s, 2.150 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 854.09     | 856.73     | 860.04     |   5.5 | 95.94
Neigh   | 0.78416    | 0.78865    | 0.79861    |   0.3 |  0.09
Comm    | 24.194     | 26.638     | 28.614     |  23.3 |  2.98
Output  | 0.00013054 | 0.00014433 | 0.00017471 |   0.0 |  0.00
Modify  | 2.4145     | 2.4637     | 2.5791     |   2.2 |  0.28
Other   |            | 6.32       |            |       |  0.71

Nlocal:            100 ave         102 max          96 min
Histogram: 1 0 0 4 0 7 12 0 13 3
Nghost:            790 ave         796 max         782 min
Histogram: 2 0 2 3 4 12 7 5 2 3
Neighs:        2729.75 ave        2816 max        2622 min
Histogram: 2 0 3 2 9 8 6 5 3 2
FullNghs:       5459.5 ave        5566 max        5230 min
Histogram: 1 0 0 4 1 6 8 4 12 4

Total # of neighbors = 218380
Ave neighs/atom = 54.595
Neighbor list builds = 3803
Dangerous builds = 0

variable pxx0 equal f_avp[1]
variable pyy0 equal f_avp[2]
variable pzz0 equal f_avp[3]
variable pxy0 equal f_avp[4]
variable pxz0 equal f_avp[5]
variable pyz0 equal f_avp[6]

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 41.0039237960889
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 40.9607948712564
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 41.0194365867588

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1--14661.4134770977)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1--14661.4134770977)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1--14292.5471938465)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1--14292.5471938465)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--14799.8695203482)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--14799.8695203482)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--5.8847536855835)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1--5.8847536855835)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--10.9895819090502)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--10.9895819090502)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--3.82603346176162)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1--3.82603346176162)/(v_delta/v_len0)*0.0001

# Write restart
write_restart restart.equil
System init for write_restart ...

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 41.0039237960889
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.003 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.0039237960889
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.410039237960889 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.410039237960889 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.410039237960889 xy delta 0 xz delta 0 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.341923 40.730397 40.759718) with tilt (0 0 0)
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.341923 40.730397 40.759718) with tilt (0 0 0)
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.341923 40.730397 40.759718) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14795.581     -7630.4228      0              0              0              0              0              0            
    160000   298.33594     -14803.195     -8364.5738     -5717.5831     -9205.5801     -9766.927      -7.5112234      6.5018112     -0.31339676   
    320000   299.70596     -14800.655     -8091.3287     -5702.6995     -9213.1156     -9755.4882     -6.5482953     -3.8228802     -11.438728    
    480000   304.90017     -14801.041     -8129.1259     -5707.5692     -9203.2003     -9771.304       3.3078231     -3.9146965      4.0748735    
    640000   294.50365     -14802.727     -8389.8977     -5700.0339     -9184.4134     -9762.0359     -5.0021528      10.626614     -6.0451786    
    800000   296.61371     -14803.308     -8383.9395     -5710.9085     -9211.7723     -9773.3477     -6.3444323     -0.19865579    -1.6886718    
    960000   297.41414     -14802.188     -8296.4046     -5724.2845     -9200.4566     -9769.3978     -6.3810402     -1.949438       2.6782101    
   1120000   298.28458     -14798.255     -7912.923      -5715.5378     -9197.0924     -9743.2834      6.8692205     -0.67925835     10.193783    
   1280000   302.97429     -14800.859     -8142.4222     -5730.659      -9216.6553     -9794.7866     -6.119095      -4.565735       2.4103713    
   1440000   307.17089     -14801.295     -8098.3005     -5693.6643     -9198.3187     -9765.1876     -0.69962198     12.322676     -0.10706106   
   1600000   296.63024     -14801.377     -8295.2673     -5704.6028     -9207.2473     -9757.2587      1.5231604     -1.2964278      1.4650235    
Loop time of 3043.95 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.415 ns/day, 0.528 hours/ns, 525.633 timesteps/s, 2.103 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2905.1     | 2913.3     | 2923.8     |  10.5 | 95.71
Neigh   | 2.6474     | 2.6587     | 2.6802     |   0.4 |  0.09
Comm    | 88.559     | 95.911     | 103.37     |  41.5 |  3.15
Output  | 0.00047063 | 0.00052616 | 0.0007019  |   0.0 |  0.00
Modify  | 8.0592     | 8.2018     | 8.4477     |   2.8 |  0.27
Other   |            | 23.93      |            |       |  0.79

Nlocal:            100 ave         103 max          97 min
Histogram: 1 2 0 10 0 14 10 0 2 1
Nghost:        788.725 ave         799 max         783 min
Histogram: 4 6 6 10 4 3 4 1 1 1
Neighs:         2738.1 ave        2871 max        2645 min
Histogram: 2 3 7 7 7 6 7 0 0 1
FullNghs:       5476.2 ave        5663 max        5322 min
Histogram: 1 2 7 3 11 9 4 2 0 1

Total # of neighbors = 219048
Ave neighs/atom = 54.762
Neighbor list builds = 12344
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   296.63024     -14801.377     -8295.2673      0              0              0              0              0              0            
    160000   303.79645     -14804.267     -8393.6705     -5702.276      -9214.0045     -9749.0575     -4.9648904     -7.162088       1.6883919    
    320000   300.75834     -14800.336     -8041.4032     -5703.9139     -9196.149      -9762.1882      0.82919217     2.1272776     -2.943056     
    480000   307.3824      -14797.424     -7784.8558     -5700.5878     -9231.1296     -9782.366       1.8166051     -11.840209      11.155007    
Loop time of 908.569 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.645 ns/day, 0.526 hours/ns, 528.304 timesteps/s, 2.113 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 868.44     | 871.25     | 874.39     |   5.8 | 95.89
Neigh   | 0.78716    | 0.79019    | 0.79506    |   0.2 |  0.09
Comm    | 24.427     | 27.426     | 29.72      |  26.1 |  3.02
Output  | 0.00013425 | 0.0001614  | 0.00019752 |   0.0 |  0.00
Modify  | 2.4101     | 2.4581     | 2.5356     |   1.6 |  0.27
Other   |            | 6.641      |            |       |  0.73

Nlocal:            100 ave         107 max          92 min
Histogram: 1 0 4 2 10 6 10 2 4 1
Nghost:          803.1 ave         814 max         793 min
Histogram: 1 4 6 2 10 6 3 5 0 3
Neighs:        2743.15 ave        2944 max        2532 min
Histogram: 1 2 2 4 10 10 4 6 0 1
FullNghs:       5486.3 ave        5865 max        5043 min
Histogram: 1 0 4 3 9 9 6 4 3 1

Total # of neighbors = 219452
Ave neighs/atom = 54.863
Neighbor list builds = 3711
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 89.6082564203089
variable C2neg equal ${d2}
variable C2neg equal 50.6141760435658
variable C3neg equal ${d3}
variable C3neg equal 50.1750347922624
variable C4neg equal ${d4}
variable C4neg equal 0.170397602354071
variable C5neg equal ${d5}
variable C5neg equal -0.008506274241036
variable C6neg equal ${d6}
variable C6neg equal 0.0564263859555533

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.004 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.0039237960889
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.410039237960889 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.410039237960889 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.410039237960889 xy delta 0 xz delta 0 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (41.162001 40.730397 40.759718) with tilt (0 0 0)
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (41.162001 40.730397 40.759718) with tilt (0 0 0)
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (41.162001 40.730397 40.759718) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14780.993     -20905.771      0              0              0              0              0              0            
    160000   291.46956     -14771.682     -20063.482     -22611.559     -19009.246     -19493.699      2.9168605     -1.2219689     -2.6704635    
    320000   307.11128     -14775.895     -20317.145     -22596.073     -18996.112     -19480.2        0.78104893    -4.5155826      12.756726    
    480000   305.90824     -14773.565     -20225.245     -22592.746     -18983.67      -19465.037     -7.6785246     -6.7590211      1.9890095    
    640000   297.41955     -14775.697     -20412.38      -22594.867     -19011.324     -19480.994      0.46740303    -1.5600999     -1.7762697    
    800000   306.01707     -14776.458     -20438.455     -22580.142     -18994.786     -19467.36       4.4472187     -2.0448575     -6.666859     
    960000   298.33096     -14772.494     -20076.365     -22631.139     -19006.971     -19471.721      11.891938      5.2550335     -1.5455648    
   1120000   300.74691     -14774.095     -20253.74      -22603.463     -19036.138     -19486.435      1.971398       5.6002571      10.891509    
   1280000   306.85343     -14775.568     -20311.867     -22613.522     -19010.456     -19483.841     -11.803152     -9.5481329      6.0484887    
   1440000   295.05842     -14773.188     -20200.842     -22584.239     -19006.149     -19473.884     -1.7539201     -0.43368087    -4.2133975    
   1600000   295.76191     -14778.555     -20720.518     -22617.343     -19012.107     -19499.748     -1.2168535     -1.9469848     -13.616788    
Loop time of 3044.21 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.411 ns/day, 0.529 hours/ns, 525.588 timesteps/s, 2.102 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2906.7     | 2916.1     | 2925.7     |  10.4 | 95.79
Neigh   | 2.8206     | 2.8304     | 2.8573     |   0.4 |  0.09
Comm    | 84.738     | 93.703     | 101.44     |  43.7 |  3.08
Output  | 0.00043132 | 0.00047067 | 0.00059496 |   0.0 |  0.00
Modify  | 8.0709     | 8.187      | 8.4914     |   3.0 |  0.27
Other   |            | 23.43      |            |       |  0.77

Nlocal:            100 ave         102 max          98 min
Histogram: 3 0 7 0 0 20 0 7 0 3
Nghost:          790.2 ave         799 max         783 min
Histogram: 2 2 2 15 3 6 5 4 0 1
Neighs:         2721.5 ave        2804 max        2635 min
Histogram: 1 2 6 3 9 6 4 4 1 4
FullNghs:         5443 ave        5557 max        5316 min
Histogram: 3 0 3 4 6 11 4 6 0 3

Total # of neighbors = 217720
Ave neighs/atom = 54.43
Neighbor list builds = 13160
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   295.76191     -14778.555     -20720.518      0              0              0              0              0              0            
    160000   298.9369      -14778.23      -20644.63      -22599.076     -19016.132     -19481.91      -0.94008893     5.3898325      2.2726377    
    320000   301.91972     -14775.368     -20351.284     -22597.631     -18999.637     -19457.698      3.148979      -7.7784202     -0.49951213   
    480000   302.36031     -14776.546     -20421.773     -22600.841     -18994.21      -19466.785     -17.253537     -9.3232384     -2.3418467    
Loop time of 909.766 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.585 ns/day, 0.526 hours/ns, 527.608 timesteps/s, 2.110 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 868.2      | 870.99     | 874.96     |   5.4 | 95.74
Neigh   | 0.83384    | 0.83739    | 0.84469    |   0.2 |  0.09
Comm    | 25.396     | 28.468     | 30.919     |  23.6 |  3.13
Output  | 0.00012543 | 0.0001537  | 0.00018961 |   0.0 |  0.00
Modify  | 2.4322     | 2.4607     | 2.5325     |   1.4 |  0.27
Other   |            | 7.012      |            |       |  0.77

Nlocal:            100 ave         108 max          92 min
Histogram: 1 0 1 13 5 5 13 1 0 1
Nghost:        798.175 ave         806 max         786 min
Histogram: 1 1 2 5 3 4 5 9 5 5
Neighs:        2722.95 ave        2963 max        2469 min
Histogram: 1 0 2 8 9 7 7 4 1 1
FullNghs:       5445.9 ave        5886 max        5003 min
Histogram: 1 0 2 12 5 5 12 2 0 1

Total # of neighbors = 217836
Ave neighs/atom = 54.459
Neighbor list builds = 3941
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 79.394276605765
variable C2pos equal ${d2}
variable C2pos equal 47.016626405106
variable C3pos equal ${d3}
variable C3pos equal 46.669158876231
variable C4pos equal ${d4}
variable C4pos equal -0.0354290702750862
variable C5pos equal ${d5}
variable C5pos equal -0.0166634350642554
variable C6pos equal ${d6}
variable C6pos equal 0.134275035779896

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(89.6082564203089+${C1pos})
variable C11 equal 0.5*(89.6082564203089+79.394276605765)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(50.6141760435658+${C2pos})
variable C21 equal 0.5*(50.6141760435658+47.016626405106)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(50.1750347922624+${C3pos})
variable C31 equal 0.5*(50.1750347922624+46.669158876231)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(0.170397602354071+${C4pos})
variable C41 equal 0.5*(0.170397602354071+-0.0354290702750862)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(-0.008506274241036+${C5pos})
variable C51 equal 0.5*(-0.008506274241036+-0.0166634350642554)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(0.0564263859555533+${C6pos})
variable C61 equal 0.5*(0.0564263859555533+0.134275035779896)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 40.9607948712564
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.003 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*40.9607948712564
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.409607948712564 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.409607948712564 yz delta 0 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.320789 40.759718) with tilt (0 0 0)
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.320789 40.759718) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.957 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14795.414     -7613.7439      0              0              0              0              0              0            
    160000   304.33404     -14803.571     -8304.7139     -9582.3995     -5240.9454     -9737.6975     -1.8831852      6.5656918      1.8756184    
    320000   309.20987     -14801.546     -8144.9348     -9610.3303     -5274.2488     -9738.2355      6.3282614     -2.4531937     -5.5531627    
    480000   294.93004     -14798.891     -8019.5737     -9586.5953     -5268.8214     -9730.1089     -4.2872915      6.4626847     -10.133575    
    640000   305.08195     -14804.044     -8435.8648     -9605.9523     -5263.0384     -9736.751      -10.409971     -5.2330731      0.35807466   
    800000   302.84254     -14802.555     -8246.9876     -9591.3927     -5275.6418     -9727.1629     -20.60154       2.796685      -2.1238465    
    960000   307.52008     -14799.843     -7989.3667     -9580.3101     -5258.8845     -9714.8954     -1.7270718      5.2735676      0.99129109   
   1120000   300.18686     -14800.109     -8055.6964     -9599.9054     -5268.4151     -9739.1666     -1.0784532      1.5111992     -1.1841158    
   1280000   302.0735      -14802.452     -8217.0422     -9586.4052     -5275.3885     -9723.3652     -3.3134696      3.7072249      4.1775051    
   1440000   300.0569      -14801.402     -8190.3743     -9578.4071     -5252.6355     -9728.8867     -3.0756438     -8.5548263     -5.1709913    
   1600000   298.68421     -14803.517     -8377.8225     -9593.5586     -5268.9454     -9755.2557     -3.6118675      3.0302175     -12.696599    
Loop time of 3067.31 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.069 ns/day, 0.533 hours/ns, 521.629 timesteps/s, 2.087 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2931.8     | 2940.5     | 2956.4     |  10.5 | 95.87
Neigh   | 2.6768     | 2.6925     | 2.7352     |   0.5 |  0.09
Comm    | 81.216     | 93.081     | 100.08     |  43.3 |  3.03
Output  | 0.00042475 | 0.00046621 | 0.00061543 |   0.0 |  0.00
Modify  | 8.0882     | 8.2378     | 10.083     |  10.6 |  0.27
Other   |            | 22.77      |            |       |  0.74

Nlocal:            100 ave         102 max          98 min
Histogram: 3 0 9 0 0 16 0 9 0 3
Nghost:        801.125 ave         810 max         793 min
Histogram: 2 2 8 4 4 8 2 7 1 2
Neighs:         2740.2 ave        2822 max        2665 min
Histogram: 3 2 3 5 11 5 3 3 4 1
FullNghs:       5480.4 ave        5604 max        5364 min
Histogram: 2 4 3 3 10 5 6 4 0 3

Total # of neighbors = 219216
Ave neighs/atom = 54.804
Neighbor list builds = 12371
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.957 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   298.68421     -14803.517     -8377.8225      0              0              0              0              0              0            
    160000   293.12231     -14800.839     -8221.5989     -9579.5301     -5248.5869     -9734.1123     -10.860874      1.9617396      1.9548917    
    320000   295.90067     -14801.866     -8212.2112     -9580.9133     -5240.2539     -9722.7607      0.30528807    -0.012714535    7.2043403    
    480000   299.16481     -14797.563     -7906.0691     -9571.6184     -5244.7594     -9736.183       5.4410306      8.4742657      2.2815617    
Loop time of 920.398 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.059 ns/day, 0.533 hours/ns, 521.514 timesteps/s, 2.086 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 876.58     | 879.3      | 882.8      |   5.9 | 95.54
Neigh   | 0.7938     | 0.79844    | 0.80921    |   0.3 |  0.09
Comm    | 27.608     | 30.686     | 32.644     |  25.4 |  3.33
Output  | 0.00013738 | 0.00014826 | 0.00018591 |   0.0 |  0.00
Modify  | 2.4476     | 2.478      | 2.5179     |   1.3 |  0.27
Other   |            | 7.133      |            |       |  0.77

Nlocal:            100 ave         106 max          94 min
Histogram: 2 1 3 3 8 14 3 3 1 2
Nghost:        819.725 ave         828 max         810 min
Histogram: 1 3 4 3 2 11 4 6 5 1
Neighs:        2740.62 ave        2929 max        2536 min
Histogram: 2 0 3 4 13 4 5 5 3 1
FullNghs:      5481.25 ave        5827 max        5138 min
Histogram: 2 1 3 5 9 10 4 3 2 1

Total # of neighbors = 219250
Ave neighs/atom = 54.8125
Neighbor list builds = 3694
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 50.8979507307362
variable C2neg equal ${d2}
variable C2neg equal 90.4778779775843
variable C3neg equal ${d3}
variable C3neg equal 50.6368652023638
variable C4neg equal ${d4}
variable C4neg equal 0.0816631535101937
variable C5neg equal ${d5}
variable C5neg equal 0.19463847589599
variable C6neg equal ${d6}
variable C6neg equal 0.0926706405787486

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.008 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*40.9607948712564
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.409607948712564 yz delta ${deltayz} remap units box
change_box all y delta 0 0.409607948712564 yz delta 0 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 41.140005 40.759718) with tilt (0 0 0)
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 41.140005 40.759718) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14781.148     -20927.833      0              0              0              0              0              0            
    160000   302.24044     -14772.279     -20088.234     -19366.693     -22278.474     -19517.206     -0.89674191    -11.01469       6.3132089    
    320000   306.92997     -14768.789     -19719.065     -19378.622     -22277.208     -19505.708      19.593118     -1.3828319      5.3686089    
    480000   297.10163     -14775.215     -20417.614     -19381.437     -22290.862     -19523.245     -7.8167002      4.384399      -7.5568082    
    640000   312.18366     -14776.047     -20390.745     -19363.567     -22283.538     -19495.846     -8.5340371      13.286159     -2.9678818    
    800000   303.43188     -14774.454     -20339.088     -19371.996     -22275.527     -19493.705      10.787268      8.3162198      1.8256839    
    960000   295.23881     -14776.631     -20515.7       -19401.323     -22296.138     -19503.988     -0.84940039    -4.2799846      6.7108578    
   1120000   300.58094     -14773.39      -20197.947     -19371.106     -22272.789     -19499.345      0.39396641     3.9637795     -4.586665     
   1280000   300.5027      -14773.096     -20118.861     -19368.58      -22283.26      -19494.989     -4.9098248      0.62313973     2.4727015    
   1440000   300.89426     -14773.53      -20151.683     -19368.863     -22270.627     -19502.121     -0.88372352     22.831705      4.264071     
   1600000   290.25611     -14776.203     -20581.952     -19367.606     -22288.919     -19490.673     -1.570071      -8.3719402     -1.860621     
Loop time of 3055.28 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.246 ns/day, 0.530 hours/ns, 523.683 timesteps/s, 2.095 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2909.3     | 2916.8     | 2928.5     |  10.2 | 95.47
Neigh   | 2.7768     | 2.7945     | 2.8851     |   1.1 |  0.09
Comm    | 94.151     | 103.76     | 109.75     |  39.6 |  3.40
Output  | 0.00038111 | 0.00042291 | 0.00055574 |   0.0 |  0.00
Modify  | 8.1542     | 8.2878     | 8.4202     |   2.3 |  0.27
Other   |            | 23.63      |            |       |  0.77

Nlocal:            100 ave         102 max          98 min
Histogram: 7 0 9 0 0 8 0 9 0 7
Nghost:          776.9 ave         783 max         770 min
Histogram: 1 0 3 10 6 3 10 2 3 2
Neighs:         2722.3 ave        2803 max        2641 min
Histogram: 4 4 1 5 4 7 6 3 4 2
FullNghs:       5444.6 ave        5568 max        5318 min
Histogram: 6 1 5 4 5 3 4 3 3 6

Total # of neighbors = 217784
Ave neighs/atom = 54.446
Neighbor list builds = 13102
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   290.25611     -14776.203     -20581.952      0              0              0              0              0              0            
    160000   294.32861     -14776.415     -20538.781     -19362.722     -22268.232     -19485.28       0.26759226     6.7339897      7.3242447    
    320000   302.27265     -14774.074     -20232.119     -19366.332     -22291.585     -19484.533      15.673954      5.5074493      4.5161895    
    480000   299.05684     -14775.682     -20415.242     -19373.08      -22287.534     -19495.925      2.6756925      3.8076217     -0.14822949   
Loop time of 912.985 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.425 ns/day, 0.528 hours/ns, 525.748 timesteps/s, 2.103 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 869.5      | 871.79     | 875.25     |   5.4 | 95.49
Neigh   | 0.81633    | 0.82264    | 0.84914    |   0.6 |  0.09
Comm    | 27.697     | 30.729     | 32.65      |  23.6 |  3.37
Output  | 0.00011686 | 0.00012745 | 0.00016574 |   0.0 |  0.00
Modify  | 2.4477     | 2.4827     | 2.5232     |   1.2 |  0.27
Other   |            | 7.158      |            |       |  0.78

Nlocal:            100 ave         106 max          94 min
Histogram: 3 1 6 2 6 10 2 6 1 3
Nghost:         778.55 ave         790 max         765 min
Histogram: 2 2 4 2 6 4 8 5 4 3
Neighs:        2721.55 ave        2921 max        2548 min
Histogram: 2 2 4 10 5 4 6 5 1 1
FullNghs:       5443.1 ave        5773 max        5123 min
Histogram: 3 1 6 4 5 7 4 6 2 2

Total # of neighbors = 217724
Ave neighs/atom = 54.431
Neighbor list builds = 3919
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 47.116663425285
variable C2pos equal ${d2}
variable C2pos equal 79.949872129457
variable C3pos equal ${d3}
variable C3pos equal 46.960554614913
variable C4pos equal ${d4}
variable C4pos equal -0.0573652419367124
variable C5pos equal ${d5}
variable C5pos equal -0.147972036574287
variable C6pos equal ${d6}
variable C6pos equal -0.0650172600309657

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(50.8979507307362+${C1pos})
variable C12 equal 0.5*(50.8979507307362+47.116663425285)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(90.4778779775843+${C2pos})
variable C22 equal 0.5*(90.4778779775843+79.949872129457)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(50.6368652023638+${C3pos})
variable C32 equal 0.5*(50.6368652023638+46.960554614913)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(0.0816631535101937+${C4pos})
variable C42 equal 0.5*(0.0816631535101937+-0.0573652419367124)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(0.19463847589599+${C5pos})
variable C52 equal 0.5*(0.19463847589599+-0.147972036574287)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(0.0926706405787486+${C6pos})
variable C62 equal 0.5*(0.0926706405787486+-0.0650172600309657)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 41.0194365867588
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.003 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.0194365867588
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.410194365867588 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.349524) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.957 | 3.957 | 3.958 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14795.547     -7630.2096      0              0              0              0              0              0            
    160000   304.13037     -14801.757     -8144.2501     -9635.4694     -9238.053      -5867.3463      0.15411205    -0.050838394   -4.658898     
    320000   295.98457     -14801.742     -8284.1835     -9616.2806     -9206.5493     -5862.2824     -0.96755373     4.5688816     -3.35477      
    480000   298.95784     -14802.043     -8288.1775     -9645.5354     -9220.4469     -5876.3942      7.716862      -1.7830865      5.3397901    
    640000   299.6621      -14800.732     -8176.9209     -9615.129      -9220.4929     -5863.1031     -4.7607844      7.7576481     -8.776595     
    800000   303.4888      -14800.503     -8059.9621     -9631.1672     -9231.5958     -5863.9842      3.6286693      1.8779921      11.143998    
    960000   304.65697     -14803.973     -8340.2322     -9624.8659     -9230.1154     -5877.3957      6.5863194      0.20958986    -7.557293     
   1120000   300.34861     -14800.488     -8169.6194     -9625.9448     -9229.071      -5861.017       9.7516359      2.9412028     -7.9556539    
   1280000   301.35741     -14802.743     -8344.8547     -9625.4919     -9221.7211     -5863.4158      1.9081476     -7.6531925      0.90608671   
   1440000   299.05731     -14802.267     -8291.0021     -9615.5107     -9216.6571     -5856.5456      0.90647156    -1.6710895     -4.6940189    
   1600000   300.77068     -14806.807     -8718.3516     -9646.9229     -9223.0342     -5871.9869     -18.949331     -1.7187782     -6.9021543    
Loop time of 3058.69 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.196 ns/day, 0.531 hours/ns, 523.100 timesteps/s, 2.092 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2909.3     | 2917.7     | 2929.8     |  10.6 | 95.39
Neigh   | 2.6761     | 2.6917     | 2.7673     |   1.0 |  0.09
Comm    | 95.576     | 105.63     | 112.86     |  41.3 |  3.45
Output  | 0.00043924 | 0.00048523 | 0.00061032 |   0.0 |  0.00
Modify  | 8.1715     | 8.2807     | 8.5593     |   2.8 |  0.27
Other   |            | 24.37      |            |       |  0.80

Nlocal:            100 ave         104 max          96 min
Histogram: 1 1 3 8 0 14 8 3 1 1
Nghost:          789.8 ave         798 max         782 min
Histogram: 4 2 4 6 2 5 9 4 2 2
Neighs:        2735.43 ave        2843 max        2629 min
Histogram: 1 1 2 7 9 9 6 1 2 2
FullNghs:      5470.85 ave        5681 max        5263 min
Histogram: 1 1 3 8 7 7 8 3 1 1

Total # of neighbors = 218834
Ave neighs/atom = 54.7085
Neighbor list builds = 12374
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.957 | 3.957 | 3.958 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   300.77068     -14806.807     -8718.3516      0              0              0              0              0              0            
    160000   298.51105     -14802.659     -8324.4034     -9620.9187     -9226.1536     -5864.7315      8.4428076      3.9952335      2.6319874    
    320000   298.28431     -14800.853     -8165.1867     -9641.8478     -9210.4275     -5867.7982     -12.93438       2.963692       12.63703     
    480000   295.90164     -14802.757     -8339.6031     -9626.5804     -9215.37       -5852.3041      14.487666      3.6441379     -2.5455325    
Loop time of 912.217 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.463 ns/day, 0.528 hours/ns, 526.190 timesteps/s, 2.105 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 868.78     | 870.99     | 874.38     |   5.3 | 95.48
Neigh   | 0.78184    | 0.78721    | 0.80424    |   0.5 |  0.09
Comm    | 27.798     | 30.919     | 32.432     |  21.1 |  3.39
Output  | 0.00012917 | 0.00014303 | 0.00018322 |   0.0 |  0.00
Modify  | 2.4452     | 2.4832     | 2.5622     |   1.6 |  0.27
Other   |            | 7.033      |            |       |  0.77

Nlocal:            100 ave         106 max          94 min
Histogram: 3 0 3 7 4 10 7 3 0 3
Nghost:        801.175 ave         811 max         793 min
Histogram: 4 4 3 8 4 6 2 4 3 2
Neighs:        2740.88 ave        2909 max        2583 min
Histogram: 2 3 5 6 5 7 3 6 1 2
FullNghs:      5481.75 ave        5796 max        5144 min
Histogram: 2 1 3 7 4 9 4 7 0 3

Total # of neighbors = 219270
Ave neighs/atom = 54.8175
Neighbor list builds = 3689
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 50.3483311872108
variable C2neg equal ${d2}
variable C2neg equal 50.7717723102707
variable C3neg equal ${d3}
variable C3neg equal 89.4756544544098
variable C4neg equal ${d4}
variable C4neg equal 0.0333922115429902
variable C5neg equal ${d5}
variable C5neg equal 0.146337197959172
variable C6neg equal ${d6}
variable C6neg equal 0.183136989753618

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.008 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.0194365867588
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.410194365867588 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 41.169913) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.955 | 3.956 | 3.956 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14781.024     -20905.516      0              0              0              0              0              0            
    160000   296.69154     -14776.719     -20533.956     -19338.345     -19004.637     -22719.031     -4.3168345     -16.63816      -2.8808394    
    320000   295.78509     -14774.017     -20288.334     -19353.962     -18993.769     -22714.964      8.7065534     -7.3704096      6.4319754    
    480000   298.35362     -14774.214     -20336.728     -19336.807     -19008.999     -22709.639      14.317941      1.1931015      1.8850948    
    640000   299.87697     -14775.618     -20367.928     -19345.295     -19002.707     -22708.672     -6.2091431     -6.01144        6.3786922    
    800000   303.62908     -14773.621     -20197.501     -19329.831     -18998.486     -22726.391     -5.7825927     -7.5070206     -7.2478763    
    960000   297.69546     -14772.901     -20185.877     -19352.63      -18992.911     -22706.656      6.2853745     -7.0025921      8.1973811    
   1120000   300.28136     -14774.38      -20320.937     -19356.959     -18988.618     -22706.775      3.1267845     -0.54005088     0.99127001   
   1280000   298.35484     -14777.661     -20595.763     -19342.733     -18994.166     -22716.843      0.75998727     3.0221091     -13.698164    
   1440000   305.61043     -14775.435     -20311.34      -19321.03      -19001.854     -22704.917      7.3862341      5.7884171      0.75951058   
   1600000   297.28783     -14774.663     -20376.257     -19338.686     -19012.049     -22712.626      3.2681371     -0.8086308      3.8867851    
Loop time of 3054.4 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.259 ns/day, 0.530 hours/ns, 523.834 timesteps/s, 2.095 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2907.6     | 2915.8     | 2926.6     |  10.1 | 95.46
Neigh   | 2.7922     | 2.8056     | 2.869      |   0.9 |  0.09
Comm    | 94.232     | 104.18     | 110.91     |  43.3 |  3.41
Output  | 0.00039742 | 0.00044203 | 0.0005729  |   0.0 |  0.00
Modify  | 8.1269     | 8.2812     | 8.454      |   2.4 |  0.27
Other   |            | 23.36      |            |       |  0.76

Nlocal:            100 ave         103 max          97 min
Histogram: 2 3 0 11 0 8 11 0 3 2
Nghost:          788.1 ave         799 max         782 min
Histogram: 2 6 13 6 4 4 2 1 0 2
Neighs:        2722.18 ave        2828 max        2613 min
Histogram: 2 0 5 6 9 2 9 3 2 2
FullNghs:      5444.35 ave        5608 max        5270 min
Histogram: 2 2 2 10 3 5 8 3 3 2

Total # of neighbors = 217774
Ave neighs/atom = 54.4435
Neighbor list builds = 13118
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.955 | 3.956 | 3.956 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   297.28783     -14774.663     -20376.257      0              0              0              0              0              0            
    160000   301.36897     -14776.854     -20514.433     -19342.456     -19008.591     -22722.512     -13.282414      16.156352     -1.242573     
    320000   302.09332     -14776.286     -20405.738     -19340.757     -18996.379     -22712.318      10.19117      -4.381777       6.632404     
    480000   297.11643     -14771.768     -19977.207     -19342.337     -18987.75      -22682.892     -6.8039531      1.1526277      4.2479965    
Loop time of 912.501 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.449 ns/day, 0.528 hours/ns, 526.027 timesteps/s, 2.104 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 869.15     | 871.39     | 874.78     |   5.5 | 95.50
Neigh   | 0.83232    | 0.83804    | 0.85726    |   0.6 |  0.09
Comm    | 27.823     | 30.754     | 32.783     |  21.4 |  3.37
Output  | 0.00011406 | 0.00012713 | 0.0001638  |   0.0 |  0.00
Modify  | 2.4307     | 2.4821     | 2.5391     |   1.5 |  0.27
Other   |            | 7.032      |            |       |  0.77

Nlocal:            100 ave         106 max          94 min
Histogram: 2 2 4 6 5 7 6 4 2 2
Nghost:        803.575 ave         814 max         795 min
Histogram: 4 2 6 5 8 3 5 3 2 2
Neighs:        2724.57 ave        2940 max        2542 min
Histogram: 1 4 5 6 8 6 4 2 3 1
FullNghs:      5449.15 ave        5777 max        5106 min
Histogram: 1 3 4 6 5 4 9 4 3 1

Total # of neighbors = 217966
Ave neighs/atom = 54.4915
Neighbor list builds = 3941
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 46.80923289592
variable C2pos equal ${d2}
variable C2pos equal 46.952023494337
variable C3pos equal ${d3}
variable C3pos equal 78.830227613883
variable C4pos equal ${d4}
variable C4pos equal -0.101327501485304
variable C5pos equal ${d5}
variable C5pos equal -0.121422095856804
variable C6pos equal ${d6}
variable C6pos equal 0.029779196577895

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(50.3483311872108+${C1pos})
variable C13 equal 0.5*(50.3483311872108+46.80923289592)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(50.7717723102707+${C2pos})
variable C23 equal 0.5*(50.7717723102707+46.952023494337)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(89.4756544544098+${C3pos})
variable C33 equal 0.5*(89.4756544544098+78.830227613883)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(0.0333922115429902+${C4pos})
variable C43 equal 0.5*(0.0333922115429902+-0.101327501485304)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(0.146337197959172+${C5pos})
variable C53 equal 0.5*(0.146337197959172+-0.121422095856804)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(0.183136989753618+${C6pos})
variable C63 equal 0.5*(0.183136989753618+0.029779196577895)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 41.0194365867588
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.003 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.0194365867588
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.410194365867588 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 -0.41019437)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14789.659     -14517.121      0              0              0              0              0              0            
    160000   303.97946     -14787.871     -14340.907     -14684.477     -14230.64      -14682.043      2.7276226      9.485037       2626.1185    
    320000   296.11273     -14790.91      -14698.608     -14707.207     -14216.68      -14692.401     -8.7084965     -1.0862977      2640.3848    
    480000   296.13436     -14788.502     -14438.8       -14694.558     -14217.811     -14700.003      1.6509044     -2.5178198      2641.5873    
    640000   301.15107     -14792.31      -14728.355     -14707.112     -14207.091     -14703.209      1.8838468     -8.7114948      2640.2922    
    800000   292.77537     -14791.081     -14733.721     -14701.292     -14222.477     -14718.79      -14.840998     -2.496417       2628.715     
    960000   300.59264     -14791.216     -14679.657     -14671.941     -14184.507     -14673.298      4.0561302     -4.8224273      2637.9066    
   1120000   301.44488     -14789.977     -14542.818     -14697.181     -14233.578     -14708.556     -3.4681108     -7.8953133      2637.8812    
   1280000   296.41559     -14790.945     -14707.66      -14700.523     -14234.913     -14699.179      3.8176044     -6.8708325      2648.769     
   1440000   300.37786     -14787.488     -14277.689     -14684.369     -14209.997     -14700.147     -4.321289      -4.973673       2636.1579    
   1600000   298.47722     -14785.279     -14133.129     -14703.652     -14229.002     -14697.697     -12.281353      0.42496011     2641.9049    
Loop time of 3054.59 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.257 ns/day, 0.530 hours/ns, 523.802 timesteps/s, 2.095 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2908.1     | 2916.2     | 2927.1     |  10.8 | 95.47
Neigh   | 2.7295     | 2.7448     | 2.7875     |   0.5 |  0.09
Comm    | 94.696     | 103.77     | 110.71     |  43.8 |  3.40
Output  | 0.00044727 | 0.00049425 | 0.00062147 |   0.0 |  0.00
Modify  | 8.1413     | 8.2789     | 8.4254     |   2.2 |  0.27
Other   |            | 23.57      |            |       |  0.77

Nlocal:            100 ave         104 max          96 min
Histogram: 1 2 3 7 0 14 7 3 2 1
Nghost:        788.575 ave         799 max         779 min
Histogram: 2 4 6 5 7 1 3 3 4 5
Neighs:           2730 ave        2858 max        2588 min
Histogram: 1 1 2 6 8 12 3 2 3 2
FullNghs:         5460 ave        5676 max        5217 min
Histogram: 1 2 1 5 6 12 7 0 4 2

Total # of neighbors = 218400
Ave neighs/atom = 54.6
Neighbor list builds = 12743
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   298.47722     -14785.279     -14133.129      0              0              0              0              0              0            
    160000   302.15013     -14789.054     -14432.737     -14688.952     -14214.733     -14682.351      4.4444503     -5.3349367      2627.6875    
    320000   301.21182     -14790.677     -14694.154     -14689.72      -14217.537     -14694.521      11.265014      0.14055013     2633.2708    
    480000   300.4223      -14789.483     -14574.117     -14685.546     -14222.717     -14677.751      0.95233184     6.348          2647.2382    
Loop time of 912.667 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.440 ns/day, 0.528 hours/ns, 525.931 timesteps/s, 2.104 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 869.39     | 871.87     | 875.29     |   5.9 | 95.53
Neigh   | 0.80961    | 0.81396    | 0.8263     |   0.3 |  0.09
Comm    | 27.67      | 30.569     | 32.462     |  24.5 |  3.35
Output  | 0.00011789 | 0.00013178 | 0.00016786 |   0.0 |  0.00
Modify  | 2.443      | 2.4818     | 2.543      |   1.3 |  0.27
Other   |            | 6.929      |            |       |  0.76

Nlocal:            100 ave         106 max          94 min
Histogram: 2 2 4 4 6 10 4 4 2 2
Nghost:        799.625 ave         812 max         785 min
Histogram: 1 4 0 3 11 6 3 6 3 3
Neighs:         2730.5 ave        2904 max        2524 min
Histogram: 1 1 4 5 2 13 5 5 2 2
FullNghs:         5461 ave        5793 max        5130 min
Histogram: 1 3 4 4 8 7 5 4 2 2

Total # of neighbors = 218440
Ave neighs/atom = 54.61
Neighbor list builds = 3823
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal -0.241330065992006
variable C2neg equal ${d2}
variable C2neg equal 0.698304308170991
variable C3neg equal ${d3}
variable C3neg equal 1.22118301254301
variable C4neg equal ${d4}
variable C4neg equal 26.5312294694948
variable C5neg equal ${d5}
variable C5neg equal 0.17337581906195
variable C6neg equal ${d6}
variable C6neg equal 0.0477836529900051

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.007 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.0194365867588
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.410194365867588 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0.41019437)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14789.639     -14511.05       0              0              0              0              0              0            
    160000   309.14351     -14788.456     -14368.325     -14651.66      -14203.58      -14703.718     -7.256854       0.81904615    -2624.4229    
    320000   300.63367     -14788.454     -14420.743     -14707.332     -14215.387     -14703.464     -0.61104558    -12.465032     -2629.9444    
    480000   304.56969     -14789.382     -14452.534     -14692.23      -14219.246     -14700.976      5.1402501     -14.200479     -2621.8185    
    640000   307.48256     -14791.831     -14700.793     -14685.437     -14215.776     -14706.108     -0.60046487    -7.9485826     -2645.5227    
    800000   294.60237     -14791.507     -14763.061     -14684.282     -14234.208     -14710.711     -15.268867     -6.6498068     -2634.8651    
    960000   295.99369     -14789.831     -14522.76      -14710.882     -14237.018     -14690.371     -6.4417828     -3.2843703     -2638.8753    
   1120000   300.32916     -14788.567     -14402.107     -14694.867     -14202.66      -14687.628     -14.012477      12.020946     -2631.7986    
   1280000   299.54061     -14790.9       -14628.175     -14709.599     -14224.642     -14702.614     -11.568205      4.9428999     -2628.2474    
   1440000   300.93842     -14789.929     -14563.795     -14698.18      -14208.022     -14701.507     -8.7743836      9.2740079     -2630.7447    
   1600000   306.07467     -14791.887     -14654.731     -14716.754     -14234.829     -14705.26      -1.6043968      12.325821     -2633.1543    
Loop time of 3054.31 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.261 ns/day, 0.530 hours/ns, 523.850 timesteps/s, 2.095 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2907.8     | 2915       | 2926.6     |  10.3 | 95.44
Neigh   | 2.7382     | 2.7526     | 2.8374     |   1.0 |  0.09
Comm    | 93.68      | 104.3      | 111.19     |  42.5 |  3.41
Output  | 0.00038795 | 0.00042514 | 0.00054573 |   0.0 |  0.00
Modify  | 8.1612     | 8.2886     | 8.6725     |   3.3 |  0.27
Other   |            | 24.01      |            |       |  0.79

Nlocal:            100 ave         104 max          96 min
Histogram: 1 0 4 8 0 14 8 4 0 1
Nghost:        786.675 ave         794 max         780 min
Histogram: 4 3 3 3 5 10 3 6 2 1
Neighs:         2727.1 ave        2874 max        2577 min
Histogram: 1 0 1 8 12 7 7 2 1 1
FullNghs:       5454.2 ave        5672 max        5222 min
Histogram: 1 0 3 5 6 12 8 4 0 1

Total # of neighbors = 218168
Ave neighs/atom = 54.542
Neighbor list builds = 12773
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   306.07467     -14791.887     -14654.731      0              0              0              0              0              0            
    160000   294.68728     -14789.791     -14554.955     -14685.061     -14226.743     -14693.673      9.3158721      5.0293569     -2642.0117    
    320000   307.33203     -14786.892     -14162.702     -14687.403     -14224.553     -14690.693     -0.15635006    -0.42211395    -2642.5664    
    480000   300.787       -14788.475     -14407.854     -14676.443     -14207.775     -14690.102     -0.092306357   -3.8017842     -2636.1238    
Loop time of 912.442 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.452 ns/day, 0.528 hours/ns, 526.061 timesteps/s, 2.104 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 869.06     | 871.38     | 874.76     |   5.3 | 95.50
Neigh   | 0.81127    | 0.81894    | 0.84142    |   0.5 |  0.09
Comm    | 27.795     | 30.642     | 32.58      |  23.8 |  3.36
Output  | 0.00011758 | 0.00013015 | 0.00016916 |   0.0 |  0.00
Modify  | 2.4475     | 2.4837     | 2.5937     |   1.7 |  0.27
Other   |            | 7.121      |            |       |  0.78

Nlocal:            100 ave         107 max          93 min
Histogram: 1 2 3 4 8 13 3 3 2 1
Nghost:        799.025 ave         809 max         789 min
Histogram: 2 4 2 7 3 6 6 4 2 4
Neighs:        2730.18 ave        2912 max        2561 min
Histogram: 3 2 3 6 5 9 5 5 1 1
FullNghs:      5460.35 ave        5827 max        5079 min
Histogram: 1 2 2 5 9 8 7 3 1 2

Total # of neighbors = 218414
Ave neighs/atom = 54.6035
Neighbor list builds = 3847
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 0.150295393924007
variable C2pos equal ${d2}
variable C2pos equal -0.847725611873993
variable C3pos equal ${d3}
variable C3pos equal -1.097673143189
variable C4pos equal ${d4}
variable C4pos equal 26.3023907753987
variable C5pos equal ${d5}
variable C5pos equal -0.0718779768921988
variable C6pos equal ${d6}
variable C6pos equal -0.0373372710426244

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(-0.241330065992006+${C1pos})
variable C14 equal 0.5*(-0.241330065992006+0.150295393924007)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(0.698304308170991+${C2pos})
variable C24 equal 0.5*(0.698304308170991+-0.847725611873993)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(1.22118301254301+${C3pos})
variable C34 equal 0.5*(1.22118301254301+-1.097673143189)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(26.5312294694948+${C4pos})
variable C44 equal 0.5*(26.5312294694948+26.3023907753987)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(0.17337581906195+${C5pos})
variable C54 equal 0.5*(0.17337581906195+-0.0718779768921988)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(0.0477836529900051+${C6pos})
variable C64 equal 0.5*(0.0477836529900051+-0.0373372710426244)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 41.0194365867588
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.003 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.0194365867588
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.410194365867588 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 -0.41019437 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14789.661     -14513.872      0              0              0              0              0              0            
    160000   302.40051     -14791.883     -14785.876     -14575.052     -14311.781     -14679.815     -8.4052877      2601.3508      2.6804806    
    320000   298.54626     -14787.362     -14298.88      -14612.162     -14324.094     -14722.988      8.7893758      2604.2358      8.7978669    
    480000   295.28758     -14789.131     -14516.891     -14602.498     -14332.444     -14707.876      0.36763001     2599.4686     -11.168195    
    640000   305.32087     -14790.646     -14553.94      -14593.506     -14310.073     -14706.589      6.5985591      2607.4566      6.2164501    
    800000   306.64576     -14790.002     -14495.281     -14581.631     -14311.258     -14680.725      3.2901323      2599.2975      2.7176645    
    960000   297.00486     -14790.962     -14675.898     -14614.58      -14332.704     -14723.325      7.4921619      2599.9383      6.7904891    
   1120000   305.21602     -14790.943     -14660.879     -14590.817     -14315.43      -14688.358     -5.4768358      2607.4554     -5.3292381    
   1280000   301.20805     -14790.218     -14586.86      -14584.317     -14305.724     -14693.59      -5.6990414      2606.4288      0.75864649   
   1440000   305.77245     -14784.249     -13971.934     -14584.923     -14307.51      -14689.143     -8.8101511      2598.1649      2.7988354    
   1600000   297.86251     -14787.75      -14420.364     -14597.769     -14304.527     -14693.982     -6.2319153      2622.9761     -6.8640815    
Loop time of 3063.27 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.128 ns/day, 0.532 hours/ns, 522.317 timesteps/s, 2.089 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2914.9     | 2922.1     | 2933.4     |   9.1 | 95.39
Neigh   | 2.7332     | 2.7469     | 2.8092     |   0.9 |  0.09
Comm    | 93.788     | 105.65     | 112.46     |  41.0 |  3.45
Output  | 0.000382   | 0.0004324  | 0.00056107 |   0.0 |  0.00
Modify  | 8.203      | 8.2978     | 8.4821     |   2.3 |  0.27
Other   |            | 24.46      |            |       |  0.80

Nlocal:            100 ave         102 max          98 min
Histogram: 6 0 7 0 0 14 0 7 0 6
Nghost:         787.35 ave         794 max         782 min
Histogram: 4 2 5 6 5 9 1 5 1 2
Neighs:         2728.3 ave        2805 max        2662 min
Histogram: 4 4 3 5 8 4 2 3 5 2
FullNghs:       5456.6 ave        5583 max        5334 min
Histogram: 6 1 4 2 9 4 4 4 3 3

Total # of neighbors = 218264
Ave neighs/atom = 54.566
Neighbor list builds = 12750
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   297.86251     -14787.75      -14420.364      0              0              0              0              0              0            
    160000   295.30606     -14789.596     -14591.202     -14595.302     -14307.876     -14704.476      0.0067732176   2614.9422     -1.958414     
    320000   303.98602     -14787.591     -14290.678     -14587.092     -14305.028     -14697.446      5.5497759      2622.3889      1.6480794    
    480000   296.01215     -14792.724     -14852.557     -14612.434     -14314.321     -14701.612     -0.67360007     2614.0085      8.0652906    
Loop time of 913.054 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.421 ns/day, 0.528 hours/ns, 525.708 timesteps/s, 2.103 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 869.93     | 871.92     | 875.85     |   5.0 | 95.49
Neigh   | 0.80809    | 0.81316    | 0.83246    |   0.5 |  0.09
Comm    | 27.109     | 30.742     | 32.684     |  23.9 |  3.37
Output  | 0.00011403 | 0.00012867 | 0.00016369 |   0.0 |  0.00
Modify  | 2.4483     | 2.4773     | 2.5449     |   1.4 |  0.27
Other   |            | 7.104      |            |       |  0.78

Nlocal:            100 ave         106 max          94 min
Histogram: 1 0 4 5 6 14 5 4 0 1
Nghost:        801.325 ave         812 max         791 min
Histogram: 6 1 2 4 9 2 5 6 2 3
Neighs:        2729.43 ave        2943 max        2498 min
Histogram: 1 0 0 7 10 10 10 1 0 1
FullNghs:      5458.85 ave        5790 max        5126 min
Histogram: 1 0 4 7 9 7 6 5 0 1

Total # of neighbors = 218354
Ave neighs/atom = 54.5885
Neighbor list builds = 3819
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.489791656179004
variable C2neg equal ${d2}
variable C2neg equal -0.21773427909
variable C3neg equal ${d3}
variable C3neg equal 0.982575753873007
variable C4neg equal ${d4}
variable C4neg equal 0.139500443237244
variable C5neg equal ${d5}
variable C5neg equal 26.2499806278055
variable C6neg equal ${d6}
variable C6neg equal 0.0315243339177174

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.007 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.0194365867588
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.410194365867588 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0.41019437 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14789.647     -14513.211      0              0              0              0              0              0            
    160000   301.20204     -14785.541     -14136.939     -14602.571     -14297.21      -14700.056     -10.409679     -2603.5783     -1.4513111    
    320000   301.93131     -14793.668     -14938.046     -14620.601     -14330.666     -14706.443      10.128045     -2607.9342      4.5461493    
    480000   301.26205     -14790.333     -14553.666     -14576.006     -14318.945     -14695.614      19.024749     -2605.5256     -4.9078152    
    640000   302.32523     -14787.03      -14238.591     -14588.08      -14282.185     -14683.542      5.9663552     -2617.5161     -3.7307587    
    800000   302.1844      -14789.86      -14575.694     -14592.749     -14309.214     -14676.787     -4.5607713     -2616.9159     -3.4588762    
    960000   303.85335     -14788.726     -14437.584     -14595.57      -14303.817     -14687.175     -0.2865597     -2606.3081      3.4254497    
   1120000   303.28712     -14789.429     -14468.933     -14604.063     -14334.911     -14706.682      0.95012717    -2615.6685      7.0279652    
   1280000   301.55911     -14793.707     -14886.58      -14608.7       -14323.137     -14690.819      4.74985       -2603.3906      10.541008    
   1440000   303.93696     -14790.22      -14534.423     -14598.655     -14302.921     -14692.709      5.3772769     -2617.195       1.9463958    
   1600000   298.13661     -14787.27      -14371.541     -14589.606     -14311.131     -14700.761     -1.6722216     -2620.049      -1.4234852    
Loop time of 3052.17 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.292 ns/day, 0.530 hours/ns, 524.217 timesteps/s, 2.097 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2906       | 2913.3     | 2925.2     |   9.6 | 95.45
Neigh   | 2.7309     | 2.7471     | 2.8117     |   1.0 |  0.09
Comm    | 92.67      | 103.77     | 110.23     |  42.2 |  3.40
Output  | 0.00038772 | 0.0004321  | 0.00054337 |   0.0 |  0.00
Modify  | 8.1691     | 8.2678     | 8.4238     |   2.2 |  0.27
Other   |            | 24.04      |            |       |  0.79

Nlocal:            100 ave         102 max          98 min
Histogram: 4 0 9 0 0 14 0 9 0 4
Nghost:          787.4 ave         795 max         782 min
Histogram: 6 1 5 11 3 3 7 1 2 1
Neighs:        2730.88 ave        2843 max        2661 min
Histogram: 5 6 5 4 5 7 5 2 0 1
FullNghs:      5461.75 ave        5608 max        5344 min
Histogram: 4 2 7 4 7 4 8 0 2 2

Total # of neighbors = 218470
Ave neighs/atom = 54.6175
Neighbor list builds = 12745
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   298.13661     -14787.27      -14371.541      0              0              0              0              0              0            
    160000   298.27446     -14789.891     -14632.463     -14595.966     -14307.315     -14679.642     -8.3522037     -2607.3741      4.0284691    
    320000   305.12066     -14788.38      -14374.008     -14590.532     -14309.151     -14704.896      8.4008064     -2621.1578     -9.9083409    
    480000   299.48975     -14794.003     -14882.758     -14603.036     -14315.703     -14701.786      4.3348735     -2615.9779      5.6980286    
Loop time of 912.429 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.452 ns/day, 0.528 hours/ns, 526.069 timesteps/s, 2.104 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 869        | 871.04     | 874.37     |   5.2 | 95.46
Neigh   | 0.80962    | 0.81578    | 0.83681    |   0.6 |  0.09
Comm    | 27.378     | 31.006     | 32.798     |  23.0 |  3.40
Output  | 0.0001364  | 0.00015064 | 0.00018629 |   0.0 |  0.00
Modify  | 2.4433     | 2.4801     | 2.5207     |   1.2 |  0.27
Other   |            | 7.091      |            |       |  0.78

Nlocal:            100 ave         108 max          92 min
Histogram: 2 1 2 6 7 11 6 2 1 2
Nghost:         802.35 ave         821 max         790 min
Histogram: 5 3 6 9 5 4 5 1 0 2
Neighs:        2729.85 ave        2957 max        2499 min
Histogram: 1 2 1 7 9 9 5 3 2 1
FullNghs:       5459.7 ave        5923 max        5017 min
Histogram: 2 1 3 5 11 8 4 3 2 1

Total # of neighbors = 218388
Ave neighs/atom = 54.597
Neighbor list builds = 3830
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.583777646610997
variable C2pos equal ${d2}
variable C2pos equal 0.231556028900995
variable C3pos equal ${d3}
variable C3pos equal -0.980839804987008
variable C4pos equal ${d4}
variable C4pos equal -0.115827822583651
variable C5pos equal ${d5}
variable C5pos equal 26.0498831445832
variable C6pos equal ${d6}
variable C6pos equal -0.0816090694862524

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(0.489791656179004+${C1pos})
variable C15 equal 0.5*(0.489791656179004+-0.583777646610997)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(-0.21773427909+${C2pos})
variable C25 equal 0.5*(-0.21773427909+0.231556028900995)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(0.982575753873007+${C3pos})
variable C35 equal 0.5*(0.982575753873007+-0.980839804987008)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(0.139500443237244+${C4pos})
variable C45 equal 0.5*(0.139500443237244+-0.115827822583651)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(26.2499806278055+${C5pos})
variable C55 equal 0.5*(26.2499806278055+26.0498831445832)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(0.0315243339177174+${C6pos})
variable C65 equal 0.5*(0.0315243339177174+-0.0816090694862524)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 40.9607948712564

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.003 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*40.9607948712564
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.409607948712564 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (-0.40960795 0 0)

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14789.694     -14514.916      0              0              0              0              0              0            
    160000   296.69891     -14791.423     -14729.176     -14579.425     -14162.323     -14792.601      2641.667      -5.2032214     -6.3195834    
    320000   301.19519     -14788.033     -14383.307     -14617.158     -14203.773     -14843.988      2632.48        1.4278776     -16.126046    
    480000   304.98294     -14789.835     -14528.573     -14605.403     -14186.456     -14842.419      2634.5339     -10.590296      5.3990582    
    640000   304.99566     -14790.851     -14551.691     -14604.563     -14181.514     -14832.034      2635.9447      14.167671     -8.2519672    
    800000   297.2844      -14789.499     -14603.056     -14598.595     -14209.529     -14842.489      2642.2269      16.259141      0.66298147   
    960000   293.56582     -14789.302     -14587.806     -14605.367     -14186.873     -14818.134      2636.365      -0.77923159     17.181207    
   1120000   303.11832     -14788.565     -14424.868     -14600.411     -14169.787     -14813.32       2651.0312     -1.8204915     -6.5813423    
   1280000   297.16273     -14789.12      -14516.158     -14592.134     -14187.547     -14828.394      2648.081       5.380621      -0.67250759   
   1440000   304.1861      -14791.439     -14692.578     -14587.393     -14167.038     -14817.86       2630.5263     -11.562502     -0.49651735   
   1600000   294.34178     -14790.366     -14660.316     -14623.41      -14196.187     -14830.365      2640.0409     -1.0150466     -6.0275838    
Loop time of 3065.3 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.098 ns/day, 0.532 hours/ns, 521.971 timesteps/s, 2.088 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2917.9     | 2925.9     | 2937.9     |   9.6 | 95.45
Neigh   | 2.7281     | 2.7425     | 2.7932     |   0.6 |  0.09
Comm    | 91.884     | 104.4      | 110.75     |  42.0 |  3.41
Output  | 0.00037485 | 0.00042129 | 0.00054141 |   0.0 |  0.00
Modify  | 8.1508     | 8.2645     | 8.4716     |   2.7 |  0.27
Other   |            | 23.97      |            |       |  0.78

Nlocal:            100 ave         103 max          97 min
Histogram: 1 4 0 6 0 18 6 0 4 1
Nghost:         787.85 ave         799 max         779 min
Histogram: 1 2 4 8 11 6 2 3 1 2
Neighs:           2731 ave        2819 max        2619 min
Histogram: 1 1 5 1 7 8 6 4 4 3
FullNghs:         5462 ave        5611 max        5322 min
Histogram: 1 4 5 1 13 5 3 4 2 2

Total # of neighbors = 218480
Ave neighs/atom = 54.62
Neighbor list builds = 12739
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   294.34178     -14790.366     -14660.316      0              0              0              0              0              0            
    160000   300.5771      -14787.833     -14339.146     -14580.991     -14186.77      -14806.656      2642.1408      1.5610964     -5.2435202    
    320000   297.5434      -14788.93      -14444.502     -14595.8       -14196.131     -14856.273      2640.2922      3.9869488     -2.998004     
    480000   296.25307     -14791.641     -14707.085     -14591.997     -14187.371     -14830.645      2636.3363      2.8304312     -1.3539738    
Loop time of 912.354 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.456 ns/day, 0.528 hours/ns, 526.111 timesteps/s, 2.104 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 868.32     | 870.68     | 875.07     |   5.6 | 95.43
Neigh   | 0.81055    | 0.81584    | 0.83181    |   0.3 |  0.09
Comm    | 27.139     | 31.108     | 33.201     |  26.6 |  3.41
Output  | 0.00012027 | 0.00013187 | 0.00016499 |   0.0 |  0.00
Modify  | 2.4412     | 2.4796     | 2.5512     |   1.5 |  0.27
Other   |            | 7.267      |            |       |  0.80

Nlocal:            100 ave         106 max          94 min
Histogram: 1 1 2 4 12 12 4 2 1 1
Nghost:        801.425 ave         810 max         789 min
Histogram: 2 1 2 2 6 9 3 7 0 8
Neighs:         2725.3 ave        2935 max        2590 min
Histogram: 2 6 5 9 6 5 5 1 0 1
FullNghs:       5450.6 ave        5804 max        5137 min
Histogram: 1 1 4 12 2 13 3 3 0 1

Total # of neighbors = 218024
Ave neighs/atom = 54.506
Neighbor list builds = 3835
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.694162324720001
variable C2neg equal ${d2}
variable C2neg equal 1.05176443275499
variable C3neg equal ${d3}
variable C3neg equal -0.307758089395993
variable C4neg equal ${d4}
variable C4neg equal 0.0453077985974068
variable C5neg equal ${d5}
variable C5neg equal 0.138200131503896
variable C6neg equal ${d6}
variable C6neg equal 26.4016230758029

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0 0 0)
  4 by 2 by 5 MPI processor grid
  pair style hybrid/overlay stores no restart info
  4000 atoms
  read_restart CPU = 0.006 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*40.9607948712564
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.409607948712564 remap units box
Changing box ...
  triclinic box = (-0.2519619 -0.23039744 -0.25971829) to (40.751962 40.730397 40.759718) with tilt (0.40960795 0 0)

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   302.3876      -14789.605     -14512.12       0              0              0              0              0              0            
    160000   296.7664      -14788.482     -14467.693     -14590.439     -14181.076     -14816.997     -2643.7427     -5.993316      -2.4792024    
    320000   304.29433     -14786.462     -14240.914     -14607.348     -14198.786     -14847.941     -2626.9674      17.733189      3.7303525    
    480000   291.99734     -14788.428     -14468.416     -14579.082     -14182.148     -14817.81      -2637.2254      12.91594      -3.1686113    
    640000   302.46688     -14789.156     -14470.065     -14591.233     -14193.578     -14807.257     -2660.0335      10.888632     -0.62547804   
    800000   296.73457     -14788.218     -14427.437     -14622.637     -14188.036     -14840.085     -2638.3612      5.7131779      11.678954    
    960000   292.68154     -14793.285     -14958.761     -14610.918     -14194.845     -14825.758     -2634.2302      15.625851     -5.1682794    
   1120000   295.69891     -14787.416     -14373.176     -14587.198     -14179.495     -14837.694     -2637.1937     -0.33326612     0.88740932   
   1280000   299.73409     -14792.575     -14793.744     -14600.244     -14196.341     -14840.048     -2650.5344     -13.880835     -4.5323894    
   1440000   304.29544     -14790.252     -14613.429     -14596.333     -14175.387     -14821.756     -2625.7214      0.37325831     5.1802591    
   1600000   297.59967     -14791.446     -14717.923     -14616.965     -14200.973     -14850.173     -2638.5659      2.1639595     -4.8964342    
Loop time of 3069.76 on 40 procs for 1600000 steps with 4000 atoms

Performance: 45.033 ns/day, 0.533 hours/ns, 521.214 timesteps/s, 2.085 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2921       | 2929       | 2941       |   9.8 | 95.42
Neigh   | 2.73       | 2.739      | 2.751      |   0.3 |  0.09
Comm    | 93.522     | 105.22     | 112.65     |  46.2 |  3.43
Output  | 0.00039101 | 0.00043127 | 0.00055049 |   0.0 |  0.00
Modify  | 8.1579     | 8.2668     | 8.4254     |   2.2 |  0.27
Other   |            | 24.52      |            |       |  0.80

Nlocal:            100 ave         103 max          97 min
Histogram: 3 2 0 10 0 10 10 0 2 3
Nghost:          790.7 ave         801 max         783 min
Histogram: 3 6 3 7 3 9 4 4 0 1
Neighs:        2727.85 ave        2853 max        2634 min
Histogram: 3 2 10 6 4 4 4 4 1 2
FullNghs:       5455.7 ave        5650 max        5277 min
Histogram: 3 2 1 9 7 5 8 2 0 3

Total # of neighbors = 218228
Ave neighs/atom = 54.557
Neighbor list builds = 12733
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style hybrid/overlay tabgap eam/fs
pair_coeff * * tabgap Al.tabgap Al no yes
Reading tabgap potential file Al.tabgap with DATE: 2024-02-04
pair_coeff * * eam/fs Al.eam.fs Al
Reading eam/fs potential file Al.eam.fs with DATE: 2024-02-04



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6.2
  ghost atom cutoff = 6.2
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair tabgap, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair eam/fs, perpetual, half/full from (1)
      attributes: half, newton on, cut 6.2
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 3.956 | 3.956 | 3.957 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   297.59967     -14791.446     -14717.923      0              0              0              0              0              0            
    160000   298.94103     -14787.36      -14348.021     -14592.051     -14183.214     -14831.795     -2648.7256      5.6650926      5.3631619    
    320000   298.86465     -14788.745     -14413.168     -14603.708     -14186.967     -14818.832     -2638.2298     -10.232687      11.545323    
    480000   294.98555     -14788.697     -14403.01      -14602.002     -14184.782     -14827.158     -2639.9503      8.3057903     -4.3938811    
Loop time of 912.179 on 40 procs for 480000 steps with 4000 atoms

Performance: 45.465 ns/day, 0.528 hours/ns, 526.212 timesteps/s, 2.105 Matom-step/s
99.3% CPU use with 40 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 868.36     | 870.34     | 873.57     |   4.9 | 95.41
Neigh   | 0.8113     | 0.81622    | 0.82012    |   0.2 |  0.09
Comm    | 27.712     | 31.324     | 32.936     |  22.3 |  3.43
Output  | 0.00011857 | 0.00013112 | 0.00016825 |   0.0 |  0.00
Modify  | 2.445      | 2.4783     | 2.5233     |   1.2 |  0.27
Other   |            | 7.219      |            |       |  0.79

Nlocal:            100 ave         106 max          94 min
Histogram: 4 0 3 4 3 15 4 3 0 4
Nghost:          800.4 ave         808 max         787 min
Histogram: 2 0 0 2 5 8 7 6 4 6
Neighs:        2728.22 ave        2892 max        2562 min
Histogram: 4 2 2 6 3 10 4 3 4 2
FullNghs:      5456.45 ave        5769 max        5128 min
Histogram: 3 1 3 4 5 11 6 2 1 4

Total # of neighbors = 218258
Ave neighs/atom = 54.5645
Neighbor list builds = 3837
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.594115098170005
variable C2pos equal ${d2}
variable C2pos equal -1.07765447927
variable C3pos equal ${d3}
variable C3pos equal 0.272888604910004
variable C4pos equal ${d4}
variable C4pos equal -0.014908725797391
variable C5pos equal ${d5}
variable C5pos equal -0.192953722021025
variable C6pos equal ${d6}
variable C6pos equal 26.361243087238

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(0.694162324720001+${C1pos})
variable C16 equal 0.5*(0.694162324720001+-0.594115098170005)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(1.05176443275499+${C2pos})
variable C26 equal 0.5*(1.05176443275499+-1.07765447927)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(-0.307758089395993+${C3pos})
variable C36 equal 0.5*(-0.307758089395993+0.272888604910004)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(0.0453077985974068+${C4pos})
variable C46 equal 0.5*(0.0453077985974068+-0.014908725797391)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(0.138200131503896+${C5pos})
variable C56 equal 0.5*(0.138200131503896+-0.192953722021025)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(26.4016230758029+${C6pos})
variable C66 equal 0.5*(26.4016230758029+26.361243087238)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 84.501266513037
variable C22all equal ${C22}
variable C22all equal 85.2138750535207
variable C33all equal ${C33}
variable C33all equal 84.1529410341464

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(49.0073070780106+${C21})
variable C12all equal 0.5*(49.0073070780106+48.8154012243359)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(48.5787820415654+${C31})
variable C13all equal 0.5*(48.5787820415654+48.4220968342467)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(48.8618979023039+${C32})
variable C23all equal 0.5*(48.8618979023039+48.7987099086384)

variable C44all equal ${C44}
variable C44all equal 26.4168101224467
variable C55all equal ${C55}
variable C55all equal 26.1499318861944
variable C66all equal ${C66}
variable C66all equal 26.3814330815204

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-0.0455173360339995+${C41})
variable C14all equal 0.5*(-0.0455173360339995+0.0674842660394924)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-0.0469929952159965+${C51})
variable C15all equal 0.5*(-0.0469929952159965+-0.0125848546526457)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(0.050023613274998+${C61})
variable C16all equal 0.5*(0.050023613274998+0.0953507108677246)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(-0.074710651851501+${C42})
variable C24all equal 0.5*(-0.074710651851501+0.0121489557867406)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(0.00691087490549749+${C52})
variable C25all equal 0.5*(0.00691087490549749+0.0233332196608515)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-0.012945023257505+${C62})
variable C26all equal 0.5*(-0.012945023257505+0.0138266902738915)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(0.0617549346770051+${C43})
variable C34all equal 0.5*(0.0617549346770051+-0.0339676449711569)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(0.00086797444299952+${C53})
variable C35all equal 0.5*(0.00086797444299952+0.012457551051184)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-0.0174347422429945+${C63})
variable C36all equal 0.5*(-0.0174347422429945+0.106458093165756)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(0.0118363103267965+${C54})
variable C45all equal 0.5*(0.0118363103267965+0.0507489210848756)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(0.0151995364000079+${C64})
variable C46all equal 0.5*(0.0151995364000079+0.00522319097369035)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-0.0273767952585645+${C65})
variable C56all equal 0.5*(-0.0273767952585645+-0.0250423677842675)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (84.501266513037+${C22all}+${C33all})/3.0
variable C11cubic equal (84.501266513037+85.2138750535207+${C33all})/3.0
variable C11cubic equal (84.501266513037+85.2138750535207+84.1529410341464)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (48.9113541511732+${C13all}+${C23all})/3.0
variable C12cubic equal (48.9113541511732+48.5004394379061+${C23all})/3.0
variable C12cubic equal (48.9113541511732+48.5004394379061+48.8303039054712)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (26.4168101224467+${C55all}+${C66all})/3.0
variable C44cubic equal (26.4168101224467+26.1499318861944+${C66all})/3.0
variable C44cubic equal (26.4168101224467+26.1499318861944+26.3814330815204)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (84.6226942002347+2*${C12cubic})/3.0
variable bulkmodulus equal (84.6226942002347+2*48.7473658315168)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 26.3160583633872
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (84.6226942002347-${C12cubic})/2.0
variable shearmodulus2 equal (84.6226942002347-48.7473658315168)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+84.6226942002347/${C12cubic})
variable poissonratio equal 1.0/(1.0+84.6226942002347/48.7473658315168)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 84.501266513037 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 85.2138750535207 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 84.1529410341464 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 48.9113541511732 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 48.5004394379061 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 48.8303039054712 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 26.4168101224467 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 26.1499318861944 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 26.3814330815204 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = 0.0109834650027464 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = -0.0297889249343211 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = 0.0726871620713613 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = -0.0312808480323802 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = 0.0151220472831745 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = 0.00044083350819325 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 0.0138936448529241 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = 0.00666276274709176 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = 0.0445116754613807 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = 0.0312926157058361 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = 0.0102113636868491 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = -0.026209581521416 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 60.7058086210894 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 26.3160583633872 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 17.937664184359 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.365504565416792
Total wall time: 15:15:16
