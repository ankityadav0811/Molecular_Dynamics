LAMMPS (22 Jul 2025)
  using 1 OpenMP thread(s) per MPI task
# Compute elastic constant tensor for a crystal at finite temperature
#
# WARNING: This script attempts to measure small differences in
# statistical averages generated by finite temperature MD simulations.
# This creates many more opportunities for errors to occur, compared
# to the zero temperature version provided in examples/ELASTIC.
# Hence, it is always a good idea to start with the zero temperature
# calculation, before attempting to use this script.
#
# Written by Aidan Thompson (Sandia, athomps@sandia.gov)
#
#  This script uses the following three include files.
#
#   init.mod      (must be modified for different crystal structures)
# 	       	  Define units, MD parameters, deformation parameters,
#		  and initial configuration of the atoms and simulation cell.
#
#
#   potential.mod    (must be modified for different pair styles)
# 		     Define pair style and other attributes
#		     not stored in restart file
#
#
#   displace.mod    (displace.mod should not need to be modified)
# 		    Perform positive and negative box displacements
# 		    in direction ${dir} and size ${up}.
# 		    It uses the resultant changes
#		    in stress to compute one
# 		    row of the elastic stiffness tensor
#
#		    Inputs variables:
#		    	   dir = the Voigt deformation component
#		    		    (1,2,3,4,5,6)
#		    Global constants:
#       	    	   up = the deformation magnitude (strain units)
#       		   cfac = conversion from LAMMPS pressure units to
#               	   output units for elastic constants
#
#
#  To run this on a different system, it should only be necessary to
#  modify the files init.mod and potential.mod. In order to calculate
#  the elastic constants correctly, care must be taken to specify
#  the correct units in init.mod (units, cfac and cunits). It is also
#  important to verify that the MD sampling of stress components
#  is generating accurate statistical averages.
#  One indication of this is that the elastic constants are insensitive
#  to the choice of the variable ${up} in init.mod. Another is to
#  check for finite size effects.
#

include init.mod
# NOTE: This script can be modified for different atomic structures,
# units, etc. See in.elastic for more info.
#

# Define the finite deformation size. Try several values of this
# variable to verify that results do not depend on it.
variable up equal 1.0e-2

# metal units, elastic constants in GPa
units		metal
variable cfac equal 1.0e-4
variable cunits string GPa

# Define MD parameters
variable nevery equal 400                  # sampling interval
variable nrepeat equal 400                 # number of samples
variable nfreq equal ${nevery}*${nrepeat} # length of one average
variable nfreq equal 400*${nrepeat} 
variable nfreq equal 400*400 
variable nthermo equal ${nfreq}           # interval for thermo output
variable nthermo equal 160000           
variable nequil equal 10*${nthermo}       # length of equilibration run
variable nequil equal 10*160000       
variable nrun equal 3*${nthermo}          # length of equilibrated run
variable nrun equal 3*160000          
variable temp equal 300.0                # temperature of initial sample
variable timestep equal 0.001             # timestep
variable mass1 equal 26.981539            # mass
variable adiabatic equal 0                # adiabatic (1) or isothermal (2)
variable tdamp equal 0.01                 # time constant for thermostat
variable seed equal 123457                # seed for thermostat
variable pdamp equal 0.1
# generate the box and atom positions using a fcc lattice
variable a equal 4.05

boundary        p p p


lattice        fcc $a
lattice        fcc 4.05
Lattice spacing in x,y,z = 4.05 4.05 4.05
region         box prism 0 10.0 0 10.0 0 10.0 0.0 0.0 0.0
create_box     1 box
Created triclinic box = (0 0 0) to (40.5 40.5 40.5) with tilt (0 0 0)
  2 by 3 by 5 MPI processor grid
create_atoms   1 box
Created 4000 atoms
  using lattice units in triclinic box = (0 0 0) to (40.5 40.5 40.5) with tilt (0 0 0)
  create_atoms CPU = 0.001 seconds



mass 1 ${mass1}
mass 1 26.981539
velocity        all create ${temp} 87287
velocity        all create 300 87287


# Compute initial state

variable thermostat equal 1
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.81 | 8.858 | 8.886 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   299.99957     -13439.96       2492.7424      0              0              0              0              0              0            
    160000   301.40355     -13282.527      15456.871      15534.725      15523.453      15498.311      0.9752343     -7.6448068     -7.1432224    
    320000   300.1758      -13280.577      15620.072      15514.492      15504.236      15509.025     -4.0735435     -6.349175      -0.75121496   
    480000   304.463       -13281.824      15523.76       15515.622      15513.386      15528.837     -3.3799234     -7.8757643     -3.702081     
    640000   297.28329     -13281.209      15507.645      15512.327      15516.441      15508.376     -4.5361835     -3.463008       4.6840565    
    800000   299.42195     -13279.296      15655.779      15502.421      15498.592      15508.576      1.7067778     -19.182237      6.5235561    
    960000   305.3832      -13282.072      15511.622      15514.198      15482.801      15499.064     -5.1650321     -7.414165       13.521876    
   1120000   300.40621     -13280.484      15607.472      15524.189      15528.62       15518.08       0.75269834     5.0811489     -5.5527653    
   1280000   299.33391     -13282.179      15467.717      15510.287      15486.941      15502.645     -6.0057414     -0.40954249    -0.48817842   
   1440000   296.13146     -13282.974      15358.297      15519.274      15508.988      15496.215     -1.2105101      2.1184882     -4.4809628    
   1600000   298.52069     -13277.861      15792.212      15522.639      15508.622      15514.272     -7.4944263     -2.056546      -1.2828976    
Loop time of 2957.05 on 30 procs for 1600000 steps with 4000 atoms

Performance: 46.749 ns/day, 0.513 hours/ns, 541.080 timesteps/s, 2.164 Matom-step/s
91.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2638.8     | 2721.5     | 2788.2     |  85.9 | 92.03
Neigh   | 1.9767     | 2.1333     | 2.3092     |   8.7 |  0.07
Comm    | 130.79     | 198.63     | 282.52     | 326.0 |  6.72
Output  | 0.00049792 | 0.00053412 | 0.00072783 |   0.0 |  0.00
Modify  | 12.229     | 12.991     | 13.823     |  13.7 |  0.44
Other   |            | 21.78      |            |       |  0.74

Nlocal:        133.333 ave         146 max         121 min
Histogram: 5 2 1 3 3 3 3 6 2 2
Nghost:        819.267 ave         868 max         782 min
Histogram: 3 5 5 4 3 0 0 4 4 2
Neighs:        3595.07 ave        3943 max        3251 min
Histogram: 6 1 2 4 1 3 2 7 2 2
FullNghs:      7190.13 ave        7875 max        6528 min
Histogram: 5 3 0 4 2 4 2 6 2 2

Total # of neighbors = 215704
Ave neighs/atom = 53.926
Neighbor list builds = 5363
Dangerous builds = 0


fix 2  all npt temp ${temp} ${temp} ${tdamp} drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 ${temp} ${tdamp} drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 300 ${tdamp} drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 300 0.01 drag 1.0 pchain 8 aniso 0.0 0.0 ${pdamp}
fix 2  all npt temp 300 300 0.01 drag 1.0 pchain 8 aniso 0.0 0.0 0.1
run ${nequil}
run 1600000
WARNING: One or more atoms are time integrated more than once
For more information see https://docs.lammps.org/err0032 (src/modify.cpp:298)
Per MPI rank memory allocation (min/avg/max) = 8.843 | 8.871 | 8.899 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
   1600000   298.52069     -13277.861      15792.212      15522.639      15508.622      15514.272     -7.4944263     -2.056546      -1.2828976    
   1760000   567.52242     -13096.159      285.091       -77.007802     -91.810327     -105.22975      11.715723      4.980871      -13.063968    
   1920000   573.12186     -13096.194      537.42244     -51.716852     -123.39668     -83.055975     -6.5348268      11.00643      -4.5481892    
   2080000   581.95749     -13100.521      242.3916      -35.251943     -50.94348      -57.563335     -8.7018068     -9.1127919      2.0741258    
   2240000   571.57964     -13098.36      -593.50695     -92.991728     -112.22083     -93.033437      25.193778      25.884577     -14.654005    
   2400000   570.41687     -13097.446      540.32227     -64.82006      -72.564268     -140.15655     -19.918673     -3.6071364     -0.22320568   
   2560000   578.05671     -13082.379     -707.75526     -88.765694     -59.991221     -75.353856      3.4744157      3.8229856      3.0033934    
   2720000   566.71851     -13098.192     -273.50825     -62.924438     -57.149801     -43.65151      -6.6408424      5.389467      -37.733346    
   2880000   583.67754     -13096.333      588.29582     -155.03013     -72.43719      -144.28617     -21.209914     -4.3944785     -13.538039    
   3040000   580.30699     -13092.043     -103.87745     -68.580931     -61.577112     -89.114862     -8.999249       26.660749     -26.381255    
   3200000   573.55441     -13099.655      207.72442     -97.03026      -116.39503     -83.09409       14.963025     -3.8688951      17.682583    
Loop time of 2983.07 on 30 procs for 1600000 steps with 4000 atoms

Performance: 46.342 ns/day, 0.518 hours/ns, 536.361 timesteps/s, 2.145 Matom-step/s
91.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2537.1     | 2662.4     | 2742.5     | 106.0 | 89.25
Neigh   | 21.187     | 23.947     | 26.043     |  35.2 |  0.80
Comm    | 138        | 216.53     | 344.12     | 385.6 |  7.26
Output  | 0.00051504 | 0.00055151 | 0.00076804 |   0.0 |  0.00
Modify  | 60.555     | 63.146     | 65.958     |  20.9 |  2.12
Other   |            | 17         |            |       |  0.57

Nlocal:        133.333 ave         143 max         118 min
Histogram: 5 4 1 0 0 0 0 1 17 2
Nghost:        849.033 ave         880 max         810 min
Histogram: 3 6 1 0 0 0 8 2 4 6
Neighs:         3473.5 ave        3725 max        3059 min
Histogram: 3 7 0 0 0 0 0 1 14 5
FullNghs:         6947 ave        7470 max        6121 min
Histogram: 4 5 1 0 0 0 0 3 14 3

Total # of neighbors = 208410
Ave neighs/atom = 52.1025
Neighbor list builds = 64138
Dangerous builds = 0
unfix 2

if "${adiabatic} == 1" then "variable thermostat equal 0" else "variable thermostat equal 1"
variable thermostat equal 1

print ${thermostat}
print 1
1

include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.848 | 8.873 | 8.899 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   573.55441     -13099.655      207.72442      0              0              0              0              0              0            
    160000   300.88002     -13247.267     -15016.598     -15085.659     -14642.299     -14777.198     -7.9345875     -17.411496     -6.9418036    
    320000   296.66528     -13247.565     -15015.631     -15073.653     -14649.936     -14765.495     -11.812053     -6.0154745     -4.4468519    
    480000   307.06101     -13246.568     -14890.188     -15103.216     -14659.429     -14787.545      6.8676108     -5.8393602      1.3824963    
Loop time of 817.858 on 30 procs for 480000 steps with 4000 atoms

Performance: 50.708 ns/day, 0.473 hours/ns, 586.899 timesteps/s, 2.348 Matom-step/s
90.5% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 716.03     | 750.83     | 769.67     |  59.7 | 91.80
Neigh   | 0.77176    | 0.90962    | 0.98837    |   9.3 |  0.11
Comm    | 35.95      | 56.265     | 91.099     | 218.6 |  6.88
Output  | 0.00011726 | 0.00014475 | 0.00019069 |   0.0 |  0.00
Modify  | 3.2514     | 3.7053     | 4.251      |  14.4 |  0.45
Other   |            | 6.149      |            |       |  0.75

Nlocal:        133.333 ave         148 max         113 min
Histogram: 1 4 4 1 0 1 5 4 7 3
Nghost:        754.367 ave         784 max         714 min
Histogram: 5 3 1 1 0 0 3 7 6 4
Neighs:        3542.43 ave        3982 max        2992 min
Histogram: 1 5 3 1 0 4 3 6 5 2
FullNghs:      7084.87 ave        7873 max        6002 min
Histogram: 1 4 4 1 0 2 4 7 4 3

Total # of neighbors = 212546
Ave neighs/atom = 53.1365
Neighbor list builds = 2459
Dangerous builds = 0

variable pxx0 equal f_avp[1]
variable pyy0 equal f_avp[2]
variable pzz0 equal f_avp[3]
variable pxy0 equal f_avp[4]
variable pxz0 equal f_avp[5]
variable pyz0 equal f_avp[6]

variable tmp equal lx
variable lx0 equal ${tmp}
variable lx0 equal 41.2087878139
variable tmp equal ly
variable ly0 equal ${tmp}
variable ly0 equal 41.1600464347122
variable tmp equal lz
variable lz0 equal ${tmp}
variable lz0 equal 41.1736635304057

# These formulas define the derivatives w.r.t. strain components
# Constants uses $, variables use v_
variable d1 equal -(v_pxx1-${pxx0})/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1--15103.216368829)/(v_delta/v_len0)*${cfac}
variable d1 equal -(v_pxx1--15103.216368829)/(v_delta/v_len0)*0.0001
variable d2 equal -(v_pyy1-${pyy0})/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1--14659.429498887)/(v_delta/v_len0)*${cfac}
variable d2 equal -(v_pyy1--14659.429498887)/(v_delta/v_len0)*0.0001
variable d3 equal -(v_pzz1-${pzz0})/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--14787.5451413787)/(v_delta/v_len0)*${cfac}
variable d3 equal -(v_pzz1--14787.5451413787)/(v_delta/v_len0)*0.0001
variable d4 equal -(v_pyz1-${pyz0})/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-1.38249625809142)/(v_delta/v_len0)*${cfac}
variable d4 equal -(v_pyz1-1.38249625809142)/(v_delta/v_len0)*0.0001
variable d5 equal -(v_pxz1-${pxz0})/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--5.83936022116832)/(v_delta/v_len0)*${cfac}
variable d5 equal -(v_pxz1--5.83936022116832)/(v_delta/v_len0)*0.0001
variable d6 equal -(v_pxy1-${pxy0})/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-6.86761084001833)/(v_delta/v_len0)*${cfac}
variable d6 equal -(v_pxy1-6.86761084001833)/(v_delta/v_len0)*0.0001

# Write restart
write_restart restart.equil
System init for write_restart ...

# uxx Perturbation

variable dir equal 1
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
variable len0 equal ${lx0}
variable len0 equal 41.2087878139
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.011 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.2087878139
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.412087878139 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.412087878139 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 -0.412087878139 xy delta 0 xz delta 0 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.442306 40.830023 40.836832) with tilt (0 0 0)
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.442306 40.830023 40.836832) with tilt (0 0 0)
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.442306 40.830023 40.836832) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.816 | 8.826 | 8.834 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13252.459     -9073.5641      0              0              0              0              0              0            
    160000   307.41075     -13254.699     -9284.1966     -7321.662      -10682.994     -10800.67      -6.6145339      7.7305482      7.1441778    
    320000   298.35655     -13255.464     -9433.5135     -7326.2752     -10663.712     -10804.559     -6.7254035      2.0663417     -0.6701366    
    480000   297.84461     -13260.331     -9809.0412     -7313.7244     -10661.567     -10778.747      1.4123851     -1.2809409     -3.8554997    
    640000   299.92013     -13258.555     -9666.1462     -7303.8204     -10653.331     -10799.999      6.5482291     -1.3870554     -4.189591     
    800000   302.38814     -13256.919     -9547.6698     -7321.9842     -10651.771     -10796.78      -12.764747      9.7325741     -0.68147493   
    960000   299.81387     -13258.306     -9651.4762     -7320.8746     -10672.253     -10790.835      10.574534      2.3065851     -7.2016483    
   1120000   297.54474     -13259.179     -9693.3083     -7304.6842     -10660.861     -10792.685      2.5391906      4.7298667      13.261027    
   1280000   291.03761     -13254.799     -9435.4605     -7322.6566     -10674.972     -10810.769      1.1629919     -1.6624152      0.66214672   
   1440000   296.82808     -13257.724     -9648.8941     -7326.5968     -10662.461     -10804.262     -0.13959057     3.3525121      3.8564013    
   1600000   298.01506     -13258.328     -9681.1392     -7321.8332     -10676.107     -10810.062     -10.385368     -2.4237603     -0.78662797   
Loop time of 2899.99 on 30 procs for 1600000 steps with 4000 atoms

Performance: 47.669 ns/day, 0.503 hours/ns, 551.726 timesteps/s, 2.207 Matom-step/s
90.1% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2518.1     | 2630.9     | 2724.8     |  98.6 | 90.72
Neigh   | 2.5642     | 2.8105     | 3.1086     |  11.1 |  0.10
Comm    | 132.97     | 220.81     | 334.99     | 320.1 |  7.61
Output  | 0.00044237 | 0.00049052 | 0.00062497 |   0.0 |  0.00
Modify  | 11.351     | 12.17      | 13.042     |  14.8 |  0.42
Other   |            | 33.29      |            |       |  1.15

Nlocal:        133.333 ave         143 max         122 min
Histogram: 1 4 1 5 3 4 1 3 4 4
Nghost:          804.5 ave         853 max         767 min
Histogram: 2 10 5 2 1 0 0 0 6 4
Neighs:         3561.4 ave        3865 max        3216 min
Histogram: 1 2 3 3 9 0 3 1 4 4
FullNghs:       7122.8 ave        7657 max        6506 min
Histogram: 1 3 2 5 3 4 1 4 4 3

Total # of neighbors = 213684
Ave neighs/atom = 53.421
Neighbor list builds = 7613
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.833 | 8.839 | 8.845 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   298.01506     -13258.328     -9681.1392      0              0              0              0              0              0            
    160000   299.83594     -13255.749     -9420.1775     -7325.154      -10668.576     -10786.926      8.7524865     -7.879145      -5.7632818    
    320000   305.04448     -13258.32      -9599.6176     -7303.7306     -10641.605     -10778.102     -3.73861       -0.48622271    -8.1009043    
    480000   294.74407     -13255.061     -9364.3593     -7311.1387     -10651.091     -10795.013     -5.5046777      2.9427763      8.0215526    
Loop time of 843.931 on 30 procs for 480000 steps with 4000 atoms

Performance: 49.141 ns/day, 0.488 hours/ns, 568.767 timesteps/s, 2.275 Matom-step/s
89.9% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 737.91     | 769.03     | 792.83     |  49.6 | 91.12
Neigh   | 0.74069    | 0.83932    | 0.92561    |   6.9 |  0.10
Comm    | 38.177     | 61.385     | 91.442     | 163.4 |  7.27
Output  | 0.00012549 | 0.00015591 | 0.00020331 |   0.0 |  0.00
Modify  | 3.2812     | 3.6225     | 3.8874     |  10.3 |  0.43
Other   |            | 9.052      |            |       |  1.07

Nlocal:        133.333 ave         144 max         118 min
Histogram: 8 2 0 0 0 0 1 5 8 6
Nghost:        822.133 ave         851 max         786 min
Histogram: 6 4 0 0 1 2 5 2 0 10
Neighs:        3556.77 ave        3919 max        3111 min
Histogram: 3 6 1 0 0 1 5 6 6 2
FullNghs:      7113.53 ave        7659 max        6288 min
Histogram: 8 2 0 0 0 0 1 4 8 7

Total # of neighbors = 213406
Ave neighs/atom = 53.3515
Neighbor list builds = 2292
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 77.9207765189728
variable C2neg equal ${d2}
variable C2neg equal 40.083386886704
variable C3neg equal ${d3}
variable C3neg equal 39.925323555224
variable C4neg equal ${d4}
variable C4neg equal 0.0663905637229092
variable C5neg equal ${d5}
variable C5neg equal 0.0878213655486584
variable C6neg equal ${d6}
variable C6neg equal -0.123722885615913

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.018 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.2087878139
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.412087878139 xy delta ${deltaxy} xz delta ${deltaxz} remap units box
change_box all x delta 0 0.412087878139 xy delta 0 xz delta ${deltaxz} remap units box
change_box all x delta 0 0.412087878139 xy delta 0 xz delta 0 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (41.266482 40.830023 40.836832) with tilt (0 0 0)
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (41.266482 40.830023 40.836832) with tilt (0 0 0)
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (41.266482 40.830023 40.836832) with tilt (0 0 0)
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.805 | 8.815 | 8.823 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13237.102     -20163.929      0              0              0              0              0              0            
    160000   300.04022     -13231.866     -19672.707     -22172.662     -18160.608     -18274.717     -10.144728     -9.2695244     -7.6053334    
    320000   297.82918     -13228.935     -19433.297     -22167.996     -18165.529     -18282.776     -16.243451      0.27813386     3.6253793    
    480000   292.61787     -13231.763     -19800.075     -22180.029     -18166.88      -18252.689      2.7129011      0.93788114    -0.048413352  
    640000   294.6782      -13226.145     -19182.204     -22165.613     -18150.305     -18262.063     -3.5043016      2.4445255     -6.9001405    
    800000   302.5377      -13230.995     -19671.769     -22163.338     -18149.134     -18243.41      -9.9408924     -5.9478695     -0.70618948   
    960000   299.32731     -13230.077     -19481.255     -22186.901     -18160.296     -18291.384      0.2534135     -7.2598571     -2.5212789    
   1120000   302.22873     -13227.026     -19257.47      -22208.721     -18173.386     -18282.206     -13.437075     -4.0727508      2.1856744    
   1280000   294.5394      -13230.361     -19629.132     -22167.047     -18167.086     -18276.234     -12.192849      3.4439505     -3.2169632    
   1440000   288.80097     -13229.812     -19582.278     -22162.593     -18149.595     -18261.209      2.6307414      11.204695     -4.9276428    
   1600000   305.27591     -13226.308     -19170.919     -22180.364     -18156.805     -18258.398     -4.0838772      0.8013295     -9.0219029    
Loop time of 2673.18 on 30 procs for 1600000 steps with 4000 atoms

Performance: 51.714 ns/day, 0.464 hours/ns, 598.538 timesteps/s, 2.394 Matom-step/s
90.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2337.2     | 2433.7     | 2509.6     |  78.1 | 91.04
Neigh   | 2.8788     | 3.14       | 3.4469     |  11.4 |  0.12
Comm    | 125        | 193.48     | 288.67     | 271.2 |  7.24
Output  | 0.0004284  | 0.00048468 | 0.00064206 |   0.0 |  0.00
Modify  | 11.362     | 12.289     | 13.967     |  16.7 |  0.46
Other   |            | 30.57      |            |       |  1.14

Nlocal:        133.333 ave         143 max         123 min
Histogram: 1 2 4 5 3 3 1 3 5 3
Nghost:        751.733 ave         811 max         718 min
Histogram: 7 8 3 2 0 0 2 5 1 2
Neighs:         3515.5 ave        3856 max        3184 min
Histogram: 1 2 4 5 5 2 4 4 2 1
FullNghs:         7031 ave        7535 max        6461 min
Histogram: 1 2 4 5 3 3 1 4 4 3

Total # of neighbors = 210930
Ave neighs/atom = 52.7325
Neighbor list builds = 8756
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.822 | 8.828 | 8.832 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   305.27591     -13226.308     -19170.919      0              0              0              0              0              0            
    160000   302.94793     -13229.051     -19392.315     -22174.984     -18153.558     -18265.059      3.7458422     -5.0616555     -7.3764745    
    320000   301.57968     -13230.922     -19665.724     -22192.286     -18168.263     -18276.695     -1.8503311     -2.9413353      1.1365435    
    480000   300.67684     -13229.917     -19551.312     -22173.489     -18147.759     -18244.879      3.7323113      4.8741949      0.79077335   
Loop time of 744.13 on 30 procs for 480000 steps with 4000 atoms

Performance: 55.732 ns/day, 0.431 hours/ns, 645.049 timesteps/s, 2.580 Matom-step/s
90.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 647.96     | 681.21     | 700.12     |  51.1 | 91.54
Neigh   | 0.82977    | 0.93715    | 1.0347     |   7.2 |  0.13
Comm    | 33.691     | 51.345     | 83.464     | 183.3 |  6.90
Output  | 0.00014149 | 0.00016235 | 0.00021429 |   0.0 |  0.00
Modify  | 3.2786     | 3.6338     | 4.0936     |  10.9 |  0.49
Other   |            | 7          |            |       |  0.94

Nlocal:        133.333 ave         144 max         118 min
Histogram: 6 4 0 0 0 0 1 2 14 3
Nghost:        799.433 ave         827 max         762 min
Histogram: 3 4 3 0 0 1 5 1 9 4
Neighs:           3517 ave        3813 max        3081 min
Histogram: 3 5 2 0 0 0 1 4 12 3
FullNghs:         7034 ave        7553 max        6227 min
Histogram: 6 4 0 0 0 0 0 2 12 6

Total # of neighbors = 211020
Ave neighs/atom = 52.755
Neighbor list builds = 2628
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 70.70272927045
variable C2pos equal ${d2}
variable C2pos equal 34.883295636641
variable C3pos equal ${d3}
variable C3pos equal 34.573336441615
variable C4pos equal ${d4}
variable C4pos equal 0.00591722913010227
variable C5pos equal ${d5}
variable C5pos equal -0.107135551162445
variable C6pos equal ${d6}
variable C6pos equal 0.0313529951266337

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(${C1neg}+${C1pos})
variable C11 equal 0.5*(77.9207765189728+${C1pos})
variable C11 equal 0.5*(77.9207765189728+70.70272927045)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(${C2neg}+${C2pos})
variable C21 equal 0.5*(40.083386886704+${C2pos})
variable C21 equal 0.5*(40.083386886704+34.883295636641)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(${C3neg}+${C3pos})
variable C31 equal 0.5*(39.925323555224+${C3pos})
variable C31 equal 0.5*(39.925323555224+34.573336441615)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(${C4neg}+${C4pos})
variable C41 equal 0.5*(0.0663905637229092+${C4pos})
variable C41 equal 0.5*(0.0663905637229092+0.00591722913010227)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(${C5neg}+${C5pos})
variable C51 equal 0.5*(0.0878213655486584+${C5pos})
variable C51 equal 0.5*(0.0878213655486584+-0.107135551162445)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(${C6neg}+${C6pos})
variable C61 equal 0.5*(-0.123722885615913+${C6pos})
variable C61 equal 0.5*(-0.123722885615913+0.0313529951266337)

# Delete dir to make sure it is not reused

variable dir delete

# uyy Perturbation

variable dir equal 2
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 41.1600464347122
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.009 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.1600464347122
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 -0.411600464347122 yz delta ${deltayz} remap units box
change_box all y delta 0 -0.411600464347122 yz delta 0 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.418423 40.836832) with tilt (0 0 0)
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.418423 40.836832) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.809 | 8.821 | 8.83 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13252.182     -9059.1081      0              0              0              0              0              0            
    160000   297.67966     -13260.293     -9911.1288     -11135.315     -6898.1903     -10775.038      2.6359218     -0.36055879    -5.8159704    
    320000   304.91983     -13261.241     -9861.7091     -11113.49      -6872.5677     -10769.226     -3.2716133     -2.1085965     -4.6832075    
    480000   301.78064     -13254.864     -9316.3617     -11104.561     -6873.0104     -10778.642      2.454109      -5.1657416     -10.609918    
    640000   300.70573     -13256.849     -9538.8169     -11082.771     -6853.5        -10751.313     -2.9176294     -3.7266764     -0.55465042   
    800000   290.81666     -13252.006     -9134.5746     -11103.906     -6871.1108     -10765.674      4.6179085      10.554548     -5.6408604    
    960000   303.37694     -13259         -9642.2104     -11107.155     -6861.6616     -10727.253     -6.7626147     -16.382054     -0.048088318  
   1120000   297.3162      -13257.984     -9646.7189     -11110.09      -6868.7479     -10770.7       -8.0727925     -4.1466322     -6.5119065    
   1280000   297.87635     -13253.678     -9253.6692     -11104.561     -6875.0278     -10747.226      2.5603596      1.5594301      7.3089072    
   1440000   298.76685     -13257.175     -9494.2559     -11113.221     -6875.6066     -10752.769      5.6261096     -9.7465125     -6.5301786    
   1600000   298.34894     -13257.048     -9544.3276     -11121.748     -6888.2265     -10784.227     -5.233632       9.2420623      0.44506697   
Loop time of 2887.75 on 30 procs for 1600000 steps with 4000 atoms

Performance: 47.871 ns/day, 0.501 hours/ns, 554.064 timesteps/s, 2.216 Matom-step/s
90.5% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2456       | 2571.4     | 2622.7     |  74.4 | 89.04
Neigh   | 2.6274     | 2.828      | 3.0686     |  10.4 |  0.10
Comm    | 189.73     | 242.39     | 349.88     | 227.9 |  8.39
Output  | 0.00047055 | 0.00055174 | 0.00073723 |   0.0 |  0.00
Modify  | 11.783     | 12.41      | 13.141     |  12.8 |  0.43
Other   |            | 58.76      |            |       |  2.03

Nlocal:        133.333 ave         143 max         123 min
Histogram: 2 3 3 2 3 5 2 2 4 4
Nghost:        785.433 ave         833 max         751 min
Histogram: 5 10 3 2 0 0 0 1 1 8
Neighs:        3557.33 ave        3911 max        3285 min
Histogram: 5 2 4 2 4 3 5 2 2 1
FullNghs:      7114.67 ave        7640 max        6558 min
Histogram: 3 4 1 3 2 5 2 2 6 2

Total # of neighbors = 213440
Ave neighs/atom = 53.36
Neighbor list builds = 7665
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.826 | 8.834 | 8.84 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   298.34894     -13257.048     -9544.3276      0              0              0              0              0              0            
    160000   302.42465     -13257.339     -9515.4574     -11111.948     -6878.236      -10754.299     -5.8186038      4.0999159     -3.7600756    
    320000   297.26899     -13260.546     -9875.3748     -11097.873     -6889.9646     -10757.045      15.403759      7.3762666      0.055837538  
    480000   296.90746     -13260.029     -9794.1399     -11110.333     -6864.5467     -10763.236     -4.4490109     -2.8257506     -1.6248993    
Loop time of 863.013 on 30 procs for 480000 steps with 4000 atoms

Performance: 48.055 ns/day, 0.499 hours/ns, 556.191 timesteps/s, 2.225 Matom-step/s
90.9% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 738.87     | 765.78     | 785.34     |  39.3 | 88.73
Neigh   | 0.76931    | 0.85861    | 0.94353    |   6.6 |  0.10
Comm    | 52.656     | 72.17      | 101.77     | 126.2 |  8.36
Output  | 0.00013541 | 0.00016208 | 0.00020479 |   0.0 |  0.00
Modify  | 3.4484     | 3.7701     | 4.0119     |   9.4 |  0.44
Other   |            | 20.43      |            |       |  2.37

Nlocal:        133.333 ave         144 max         118 min
Histogram: 6 4 0 0 0 0 1 4 10 5
Nghost:          838.3 ave         871 max         788 min
Histogram: 1 3 5 1 0 1 5 3 5 6
Neighs:        3559.53 ave        3841 max        3150 min
Histogram: 8 2 0 0 0 0 1 4 9 6
FullNghs:      7119.07 ave        7671 max        6286 min
Histogram: 6 4 0 0 0 0 0 5 10 5

Total # of neighbors = 213572
Ave neighs/atom = 53.393
Neighbor list builds = 2284
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 39.928835469431
variable C2neg equal ${d2}
variable C2neg equal 77.9488279758835
variable C3neg equal ${d3}
variable C3neg equal 40.243089542763
variable C4neg equal ${d4}
variable C4neg equal -0.0300739558210866
variable C5neg equal ${d5}
variable C5neg equal 0.0301360965141563
variable C6neg equal ${d6}
variable C6neg equal -0.113166217265711

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.015 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.1600464347122
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box
change_box all y delta 0 0.411600464347122 yz delta ${deltayz} remap units box
change_box all y delta 0 0.411600464347122 yz delta 0 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 41.241624 40.836832) with tilt (0 0 0)
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 41.241624 40.836832) with tilt (0 0 0)
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.806 | 8.818 | 8.827 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13237.373     -20179.373      0              0              0              0              0              0            
    160000   306.46949     -13232.936     -19791.15      -18583.482     -21754.297     -18306.169      4.4654218     -7.6074973     -11.756952    
    320000   300.03408     -13231.717     -19701.718     -18589.755     -21740.967     -18299.407      11.879049     -17.970027     -8.3478664    
    480000   293.45963     -13229.696     -19598.5       -18597.982     -21768.773     -18308.195      0.82184696     1.9118284     -8.1522137    
    640000   305.3796      -13232.072     -19687.289     -18609.44      -21763.956     -18315.85       7.1958913     -10.214726      1.6863185    
    800000   299.01425     -13229.307     -19415.075     -18588.58      -21779         -18304.007     -3.4500286     -2.0778983      12.237002    
    960000   303.2518      -13229.198     -19411.837     -18589.02      -21759.042     -18318.011      1.8412596     -12.049637     -0.83833216   
   1120000   305.91052     -13231.699     -19666.035     -18586.747     -21750.743     -18281.026      8.2969512     -7.2695347     -2.9208799    
   1280000   301.92497     -13231.118     -19581.945     -18605.627     -21762.428     -18317.455      10.458344     -7.3370687      1.4714072    
   1440000   300.33793     -13232.491     -19741.275     -18599.275     -21789.759     -18336.565     -1.7150087      1.9457822     -9.6038939    
   1600000   303.73658     -13231.056     -19570.451     -18602.495     -21771.057     -18316.399     -1.3869192      9.3215632      6.9726434    
Loop time of 2820.2 on 30 procs for 1600000 steps with 4000 atoms

Performance: 49.018 ns/day, 0.490 hours/ns, 567.335 timesteps/s, 2.269 Matom-step/s
91.1% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2385.2     | 2506       | 2572.3     |  92.3 | 88.86
Neigh   | 2.9317     | 3.1912     | 3.5231     |  11.3 |  0.11
Comm    | 180.2      | 246.28     | 375.48     | 306.1 |  8.73
Output  | 0.0004638  | 0.00051768 | 0.00068684 |   0.0 |  0.00
Modify  | 11.61      | 12.389     | 13.424     |  13.3 |  0.44
Other   |            | 52.33      |            |       |  1.86

Nlocal:        133.333 ave         144 max         123 min
Histogram: 3 2 4 5 3 1 4 2 3 3
Nghost:        756.867 ave         809 max         719 min
Histogram: 4 7 7 2 0 0 1 0 6 3
Neighs:         3516.8 ave        3798 max        3207 min
Histogram: 2 2 3 4 5 1 2 5 3 3
FullNghs:       7033.6 ave        7607 max        6455 min
Histogram: 2 2 3 7 2 2 4 3 2 3

Total # of neighbors = 211008
Ave neighs/atom = 52.752
Neighbor list builds = 8719
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.824 | 8.831 | 8.837 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   303.73658     -13231.056     -19570.451      0              0              0              0              0              0            
    160000   300.10105     -13232.265     -19729.106     -18586.61      -21734.425     -18307.531      1.6177976      5.7860052      0.5314567    
    320000   295.17107     -13230.593     -19711.912     -18600.516     -21745.469     -18305.723      7.2763746      3.2189734     -16.74198     
    480000   308.80967     -13230.882     -19556.37      -18605.174     -21781.948     -18322.779     -12.897453      5.9237842      2.6509019    
Loop time of 854.109 on 30 procs for 480000 steps with 4000 atoms

Performance: 48.556 ns/day, 0.494 hours/ns, 561.989 timesteps/s, 2.248 Matom-step/s
91.3% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 712.07     | 761.9      | 786.11     |  62.5 | 89.20
Neigh   | 0.82055    | 0.93468    | 1.0344     |   7.5 |  0.11
Comm    | 52.876     | 76.628     | 126.71     | 200.6 |  8.97
Output  | 0.00013973 | 0.00016609 | 0.00021344 |   0.0 |  0.00
Modify  | 3.2673     | 3.6412     | 3.9192     |  10.5 |  0.43
Other   |            | 11.01      |            |       |  1.29

Nlocal:        133.333 ave         143 max         117 min
Histogram: 3 6 1 0 0 0 0 2 11 7
Nghost:          807.3 ave         840 max         769 min
Histogram: 5 4 1 0 2 2 3 3 8 2
Neighs:         3519.1 ave        3785 max        3069 min
Histogram: 2 6 2 0 0 0 0 4 11 5
FullNghs:       7038.2 ave        7538 max        6160 min
Histogram: 3 5 2 0 0 0 0 2 10 8

Total # of neighbors = 211146
Ave neighs/atom = 52.7865
Neighbor list builds = 2600
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 35.01957264271
variable C2pos equal ${d2}
variable C2pos equal 71.225189271134
variable C3pos equal ${d3}
variable C3pos equal 35.352338103552
variable C4pos equal ${d4}
variable C4pos equal -0.0126840563778406
variable C5pos equal ${d5}
variable C5pos equal -0.117631443791579
variable C6pos equal ${d6}
variable C6pos equal 0.197650640924784

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(${C1neg}+${C1pos})
variable C12 equal 0.5*(39.928835469431+${C1pos})
variable C12 equal 0.5*(39.928835469431+35.01957264271)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(${C2neg}+${C2pos})
variable C22 equal 0.5*(77.9488279758835+${C2pos})
variable C22 equal 0.5*(77.9488279758835+71.225189271134)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(${C3neg}+${C3pos})
variable C32 equal 0.5*(40.243089542763+${C3pos})
variable C32 equal 0.5*(40.243089542763+35.352338103552)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(${C4neg}+${C4pos})
variable C42 equal 0.5*(-0.0300739558210866+${C4pos})
variable C42 equal 0.5*(-0.0300739558210866+-0.0126840563778406)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(${C5neg}+${C5pos})
variable C52 equal 0.5*(0.0301360965141563+${C5pos})
variable C52 equal 0.5*(0.0301360965141563+-0.117631443791579)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(${C6neg}+${C6pos})
variable C62 equal 0.5*(-0.113166217265711+${C6pos})
variable C62 equal 0.5*(-0.113166217265711+0.197650640924784)

# Delete dir to make sure it is not reused

variable dir delete

# uzz Perturbation

variable dir equal 3
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 41.1736635304057
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.009 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.1736635304057
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 -0.411736635304057 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.425095) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.821 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13252.187     -9054.9541      0              0              0              0              0              0            
    160000   300.56325     -13259.239     -9757.5233     -11133.731     -10638.754     -7015.4296      7.2089586     -1.6368403      8.2205373    
    320000   302.45367     -13258.023     -9680.9071     -11091.783     -10616.095     -6976.0388      16.194342     -7.1371523     -3.6773224    
    480000   292.21137     -13258.604     -9788.2674     -11091.499     -10621.234     -6971.7246     -1.0010506     -10.621211     -4.0141221    
    640000   293.27016     -13257.739     -9560.6837     -11131.054     -10646.417     -6994.2528      5.712557       10.824787      5.4990122    
    800000   294.45663     -13261.781     -10034.567     -11121.109     -10639.52      -6988.4609     -10.837301     -0.61707706     16.928182    
    960000   299.17336     -13259.586     -9802.9346     -11095.119     -10622.859     -6988.8575      3.7809806      8.0317612      0.66659393   
   1120000   295.08414     -13255.467     -9474.72       -11132.217     -10666.604     -7018.5197     -8.2722181     -9.9092146     -8.0207137    
   1280000   298.41389     -13259.42      -9736.3034     -11107.209     -10642.68      -6985.0993      4.7263622      4.684936       3.6734266    
   1440000   296.38242     -13255.605     -9471.989      -11122.416     -10648.512     -6995.4344      11.599422     -5.6813505      11.752959    
   1600000   301.21537     -13255.891     -9378.0592     -11123.817     -10634.329     -6991.8542     -2.899977       5.3132075     -3.5950765    
Loop time of 2838.2 on 30 procs for 1600000 steps with 4000 atoms

Performance: 48.707 ns/day, 0.493 hours/ns, 563.737 timesteps/s, 2.255 Matom-step/s
91.6% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2388.4     | 2525.2     | 2607.2     | 121.9 | 88.97
Neigh   | 2.5907     | 2.8167     | 3.0924     |  10.2 |  0.10
Comm    | 175.18     | 250.94     | 396.29     | 397.7 |  8.84
Output  | 0.00043798 | 0.00048576 | 0.0006283  |   0.0 |  0.00
Modify  | 11.59      | 12.36      | 13.316     |  14.0 |  0.44
Other   |            | 46.83      |            |       |  1.65

Nlocal:        133.333 ave         143 max         123 min
Histogram: 1 3 3 4 5 1 2 4 4 3
Nghost:        778.567 ave         830 max         738 min
Histogram: 2 6 6 5 1 0 0 3 5 2
Neighs:         3558.5 ave        3849 max        3294 min
Histogram: 3 3 4 4 2 3 2 3 5 1
FullNghs:         7117 ave        7641 max        6558 min
Histogram: 1 4 2 6 3 2 1 4 5 2

Total # of neighbors = 213510
Ave neighs/atom = 53.3775
Neighbor list builds = 7623
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.827 | 8.834 | 8.844 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   301.21537     -13255.891     -9378.0592      0              0              0              0              0              0            
    160000   301.2994      -13254.326     -9294.8629     -11111.534     -10632.431     -7023.1689      3.8752381     -10.727654      1.9363758    
    320000   307.96727     -13254.105     -9156.1539     -11103.213     -10611.332     -6985.6121     -0.34836816     0.89139558    -1.4955688    
    480000   298.76439     -13256.694     -9489.381      -11109.194     -10628.101     -6988.0418      5.2830085      0.84942895     6.2415228    
Loop time of 784.745 on 30 procs for 480000 steps with 4000 atoms

Performance: 52.848 ns/day, 0.454 hours/ns, 611.664 timesteps/s, 2.447 Matom-step/s
91.6% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 695.65     | 717.83     | 733.47     |  40.4 | 91.47
Neigh   | 0.7687     | 0.85705    | 0.93645    |   6.5 |  0.11
Comm    | 38.061     | 54.226     | 77.255     | 153.6 |  6.91
Output  | 0.00012656 | 0.00014052 | 0.00018883 |   0.0 |  0.00
Modify  | 3.4278     | 3.7253     | 3.9491     |   9.3 |  0.47
Other   |            | 8.108      |            |       |  1.03

Nlocal:        133.333 ave         144 max         117 min
Histogram: 4 5 1 0 0 0 0 4 13 3
Nghost:        821.333 ave         850 max         779 min
Histogram: 4 5 1 0 0 0 1 5 8 6
Neighs:        3558.47 ave        3841 max        3097 min
Histogram: 3 4 3 0 0 0 0 6 10 4
FullNghs:      7116.93 ave        7709 max        6246 min
Histogram: 4 5 1 0 0 0 1 5 11 3

Total # of neighbors = 213508
Ave neighs/atom = 53.377
Neighbor list builds = 2291
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 39.940227800673
variable C2neg equal ${d2}
variable C2neg equal 40.313283325528
variable C3neg equal ${d3}
variable C3neg equal 77.9950337845838
variable C4neg equal ${d4}
variable C4neg equal 0.0485902652221052
variable C5neg equal ${d5}
variable C5neg equal 0.0668878916872977
variable C6neg equal ${d6}
variable C6neg equal -0.0158460230750676

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.022 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.1736635304057
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
change_box all z delta 0 ${delta} remap units box
change_box all z delta 0 0.411736635304057 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 41.248568) with tilt (0 0 0)
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.807 | 8.82 | 8.828 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13237.356     -20182.317      0              0              0              0              0              0            
    160000   300.72227     -13230.5       -19577.267     -18582.282     -18185.538     -21889.872     -0.65958667    -10.782898      0.5284008    
    320000   294.84312     -13231.082     -19661.486     -18569.338     -18167.369     -21851.517     -14.050267      10.894747      3.7414803    
    480000   299.86463     -13230.303     -19511.83      -18583.044     -18182.655     -21876.665     -10.139856      2.9508815     -17.259749    
    640000   297.6317      -13234.016     -19940.619     -18582.878     -18190.843     -21881.293      2.6568657      5.6263668     -9.9071045    
    800000   292.20424     -13232.296     -19788.475     -18578.925     -18196.8       -21882.767     -0.32948052    -0.93663934     0.34608012   
    960000   295.76303     -13230.562     -19581.823     -18552.714     -18164.561     -21855.645      9.9934456     -5.8878095      3.0045677    
   1120000   298.855       -13230.95      -19618.924     -18550.064     -18157.694     -21856.291     -14.429263     -11.437046     -8.3788031    
   1280000   299.86413     -13232.244     -19693.607     -18580.267     -18183.039     -21878.289      9.5037678      1.1322827     -13.628308    
   1440000   298.35896     -13230.231     -19552.552     -18576.744     -18198.702     -21883.524      0.034025459   -16.768285      0.1129682    
   1600000   297.49535     -13227.45      -19256.74      -18605.68      -18223.316     -21899.289      14.427676      6.6522944      6.6906631    
Loop time of 2751.96 on 30 procs for 1600000 steps with 4000 atoms

Performance: 50.233 ns/day, 0.478 hours/ns, 581.404 timesteps/s, 2.326 Matom-step/s
91.7% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2359.7     | 2430.2     | 2493.8     |  62.6 | 88.31
Neigh   | 2.8667     | 3.1249     | 3.4402     |  11.5 |  0.11
Comm    | 181.05     | 242.59     | 315.18     | 211.9 |  8.82
Output  | 0.00042046 | 0.0005606  | 0.00069573 |   0.0 |  0.00
Modify  | 11.478     | 12.223     | 13.004     |  13.4 |  0.44
Other   |            | 63.79      |            |       |  2.32

Nlocal:        133.333 ave         143 max         122 min
Histogram: 3 1 3 5 2 3 2 1 5 5
Nghost:        770.767 ave         826 max         736 min
Histogram: 9 5 4 1 1 0 0 1 5 4
Neighs:        3513.97 ave        3820 max        3187 min
Histogram: 4 1 1 5 5 2 1 3 7 1
FullNghs:      7027.93 ave        7552 max        6422 min
Histogram: 3 1 3 5 2 4 1 3 3 5

Total # of neighbors = 210838
Ave neighs/atom = 52.7095
Neighbor list builds = 8739
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.825 | 8.833 | 8.84 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   297.49535     -13227.45      -19256.74       0              0              0              0              0              0            
    160000   295.8253      -13230.485     -19614.122     -18583.213     -18177.839     -21877.508     -1.4443575      6.6850497     -0.89964203   
    320000   305.49287     -13231.385     -19603.117     -18591.778     -18179.963     -21880.855      0.1022971      3.2997517      11.592498    
    480000   296.20173     -13229.535     -19541.027     -18581.823     -18196.857     -21884.526      0.16327155     4.9892354     -5.3700708    
Loop time of 792.344 on 30 procs for 480000 steps with 4000 atoms

Performance: 52.341 ns/day, 0.459 hours/ns, 605.797 timesteps/s, 2.423 Matom-step/s
91.6% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 677.18     | 703.4      | 717.63     |  37.9 | 88.77
Neigh   | 0.8367     | 0.9376     | 1.0311     |   7.0 |  0.12
Comm    | 51.403     | 67.531     | 95.159     | 130.1 |  8.52
Output  | 0.0001178  | 0.00014741 | 0.00019914 |   0.0 |  0.00
Modify  | 3.3263     | 3.6472     | 3.871      |   9.0 |  0.46
Other   |            | 16.83      |            |       |  2.12

Nlocal:        133.333 ave         143 max         116 min
Histogram: 3 4 3 0 0 0 0 1 13 6
Nghost:            813 ave         851 max         784 min
Histogram: 5 6 4 2 2 0 1 0 6 4
Neighs:        3519.17 ave        3783 max        3076 min
Histogram: 5 3 1 1 0 0 0 2 10 8
FullNghs:      7038.33 ave        7573 max        6114 min
Histogram: 3 4 2 1 0 0 0 2 12 6

Total # of neighbors = 211150
Ave neighs/atom = 52.7875
Neighbor list builds = 2614
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal 34.786070286142
variable C2pos equal ${d2}
variable C2pos equal 35.374274245843
variable C3pos equal ${d3}
variable C3pos equal 70.969811839323
variable C4pos equal ${d4}
variable C4pos equal 0.0675256704117351
variable C5pos equal ${d5}
variable C5pos equal -0.108285956255907
variable C6pos equal ${d6}
variable C6pos equal 0.0670433929276136

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(${C1neg}+${C1pos})
variable C13 equal 0.5*(39.940227800673+${C1pos})
variable C13 equal 0.5*(39.940227800673+34.786070286142)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(${C2neg}+${C2pos})
variable C23 equal 0.5*(40.313283325528+${C2pos})
variable C23 equal 0.5*(40.313283325528+35.374274245843)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(${C3neg}+${C3pos})
variable C33 equal 0.5*(77.9950337845838+${C3pos})
variable C33 equal 0.5*(77.9950337845838+70.969811839323)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(${C4neg}+${C4pos})
variable C43 equal 0.5*(0.0485902652221052+${C4pos})
variable C43 equal 0.5*(0.0485902652221052+0.0675256704117351)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(${C5neg}+${C5pos})
variable C53 equal 0.5*(0.0668878916872977+${C5pos})
variable C53 equal 0.5*(0.0668878916872977+-0.108285956255907)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(${C6neg}+${C6pos})
variable C63 equal 0.5*(-0.0158460230750676+${C6pos})
variable C63 equal 0.5*(-0.0158460230750676+0.0670433929276136)

# Delete dir to make sure it is not reused

variable dir delete

# uyz Perturbation

variable dir equal 4
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 41.1736635304057
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.009 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.1736635304057
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta -0.411736635304057 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 -0.41173664)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.82 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13245.899     -14804.571      0              0              0              0              0              0            
    160000   302.97481     -13246.553     -14837.556     -15086.031     -14542.091     -14642.554     -2.2756369      3.5155052      2880.9597    
    320000   298.18629     -13245.213     -14775.69      -15055.756     -14525.006     -14598.029     -10.024659     -8.4432863      2846.926     
    480000   296.77196     -13248.495     -15044.644     -15101.177     -14554.782     -14616.863      2.9680318     -12.344984      2860.868     
    640000   297.26205     -13243.269     -14628.023     -15086.748     -14546.088     -14612.19      -3.2191764      10.553229      2847.8333    
    800000   303.11798     -13243.51      -14645.398     -15085.634     -14517.648     -14630.202      10.064482     -2.4001528      2854.8642    
    960000   297.82685     -13241.938     -14497.959     -15087.044     -14547.168     -14641.849      0.71163828     2.4229991      2860.3844    
   1120000   293.07485     -13246.246     -14904.214     -15078.864     -14527.138     -14613.811      0.85347868     3.6460143      2853.5382    
   1280000   299.89639     -13246.464     -14876.614     -15109.354     -14559.205     -14639.378     -2.0260501     -0.90462379     2858.5443    
   1440000   297.81831     -13248.22      -15033.26      -15087.982     -14556.493     -14634.587     -2.9397205      0.90918022     2854.013     
   1600000   299.99792     -13244.187     -14607.06      -15070.374     -14518.512     -14588.166     -4.1491176      6.8687187      2869.7924    
Loop time of 2708.72 on 30 procs for 1600000 steps with 4000 atoms

Performance: 51.035 ns/day, 0.470 hours/ns, 590.686 timesteps/s, 2.363 Matom-step/s
91.5% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2309.2     | 2396.6     | 2445.8     |  65.1 | 88.48
Neigh   | 2.6996     | 2.9224     | 3.1901     |  10.8 |  0.11
Comm    | 189.76     | 237.98     | 323.66     | 209.4 |  8.79
Output  | 0.00041141 | 0.00045573 | 0.00060343 |   0.0 |  0.00
Modify  | 11.371     | 12.063     | 12.795     |  13.2 |  0.45
Other   |            | 59.19      |            |       |  2.19

Nlocal:        133.333 ave         143 max         124 min
Histogram: 2 5 3 5 1 1 3 4 3 3
Nghost:        772.533 ave         827 max         735 min
Histogram: 5 8 6 1 0 0 0 0 6 4
Neighs:        3537.97 ave        3830 max        3264 min
Histogram: 3 4 4 0 5 3 2 4 3 2
FullNghs:      7075.93 ave        7584 max        6577 min
Histogram: 2 5 3 5 1 1 2 4 4 3

Total # of neighbors = 212278
Ave neighs/atom = 53.0695
Neighbor list builds = 8209
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.826 | 8.833 | 8.839 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   299.99792     -13244.187     -14607.06       0              0              0              0              0              0            
    160000   299.88212     -13243.427     -14643.463     -15088.027     -14535.131     -14629.811      8.4823906     -9.1669945      2869.7727    
    320000   299.01165     -13245.703     -14857.839     -15103.12      -14552.189     -14622.604      0.55804704     9.1126954      2868.9977    
    480000   296.82753     -13250.012     -15247.68      -15087.7       -14538.278     -14623.243     -0.41057876    -5.9134468      2866.2662    
Loop time of 748.565 on 30 procs for 480000 steps with 4000 atoms

Performance: 55.402 ns/day, 0.433 hours/ns, 641.227 timesteps/s, 2.565 Matom-step/s
91.4% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 649.63     | 677.52     | 694.7      |  44.0 | 90.51
Neigh   | 0.78592    | 0.87368    | 0.9505     |   6.7 |  0.12
Comm    | 37.822     | 56.008     | 84.466     | 156.5 |  7.48
Output  | 0.00012423 | 0.00013884 | 0.0001963  |   0.0 |  0.00
Modify  | 3.3097     | 3.5839     | 3.8033     |   8.8 |  0.48
Other   |            | 10.58      |            |       |  1.41

Nlocal:        133.333 ave         144 max         117 min
Histogram: 3 6 1 0 0 0 1 2 14 3
Nghost:          818.1 ave         852 max         781 min
Histogram: 6 3 1 0 2 5 3 0 3 7
Neighs:        3542.57 ave        3806 max        3112 min
Histogram: 6 1 3 0 0 0 1 4 6 9
FullNghs:      7085.13 ave        7657 max        6214 min
Histogram: 3 6 1 0 0 0 1 3 12 4

Total # of neighbors = 212554
Ave neighs/atom = 53.1385
Neighbor list builds = 2462
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 0.155168350825006
variable C2neg equal ${d2}
variable C2neg equal 1.21151589396701
variable C3neg equal ${d3}
variable C3neg equal 1.64302246274099
variable C4neg equal ${d4}
variable C4neg equal 28.6488373655892
variable C5neg equal ${d5}
variable C5neg equal -0.000740866241191194
variable C6neg equal ${d6}
variable C6neg equal -0.0727818959532374

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.015 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.1736635304057
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
change_box all yz delta ${delta} remap units box
change_box all yz delta 0.411736635304057 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0.41173664)
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.82 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13245.858     -14804.044      0              0              0              0              0              0            
    160000   301.59708     -13243.245     -14537.449     -15100.553     -14544.005     -14635.272     -5.2677796      12.523689     -2867.6229    
    320000   299.13621     -13245.896     -14884.295     -15091.137     -14538.99      -14627.772      2.4881035     -7.4081516     -2870.7697    
    480000   297.04698     -13245.307     -14843.807     -15096.627     -14538.899     -14622.139      12.729534     -0.8705165     -2863.452     
    640000   301.89771     -13244.899     -14755.962     -15093.213     -14533.06      -14617.372     -9.8611464     -4.0454092     -2865.2209    
    800000   301.63074     -13245.562     -14823.235     -15079.749     -14533.858     -14627.483     -12.144416      18.707574     -2863.8799    
    960000   296.12018     -13245.511     -14830.468     -15118.511     -14570.722     -14642.281      1.0616181     -1.4843455     -2861.7701    
   1120000   298.61884     -13246.857     -14897.241     -15103.27      -14549.509     -14634.488     -1.1515023      4.9056702     -2853.7508    
   1280000   296.82243     -13250.09      -15304.694     -15086.959     -14536.944     -14630.455      1.0464494     -3.5698525     -2869.9202    
   1440000   302.84477     -13246.122     -14819.338     -15104.772     -14545.746     -14637.657     -2.0037698     -14.345772     -2861.8918    
   1600000   297.39648     -13247.184     -14965.396     -15087.47      -14514.086     -14608.427      7.4413668      1.3938953     -2855.4466    
Loop time of 2477.75 on 30 procs for 1600000 steps with 4000 atoms

Performance: 55.793 ns/day, 0.430 hours/ns, 645.747 timesteps/s, 2.583 Matom-step/s
91.5% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2163.9     | 2249.5     | 2295.4     |  63.4 | 90.79
Neigh   | 2.7048     | 2.9164     | 3.1751     |  10.6 |  0.12
Comm    | 137.55     | 179.62     | 266.71     | 229.7 |  7.25
Output  | 0.00041466 | 0.00046294 | 0.00067011 |   0.0 |  0.00
Modify  | 11.299     | 11.947     | 12.604     |  12.1 |  0.48
Other   |            | 33.79      |            |       |  1.36

Nlocal:        133.333 ave         143 max         123 min
Histogram: 2 3 2 4 2 5 2 1 3 6
Nghost:        769.433 ave         823 max         729 min
Histogram: 5 4 6 4 1 0 0 1 5 4
Neighs:         3541.2 ave        3815 max        3247 min
Histogram: 3 1 4 3 3 4 3 1 6 2
FullNghs:       7082.4 ave        7605 max        6492 min
Histogram: 2 3 2 4 2 6 2 0 5 4

Total # of neighbors = 212472
Ave neighs/atom = 53.118
Neighbor list builds = 8232
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.825 | 8.833 | 8.839 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   297.39648     -13247.184     -14965.396      0              0              0              0              0              0            
    160000   295.23657     -13244.791     -14828.848     -15071.857     -14529.073     -14617.704     -2.7309389      1.168237      -2862.5088    
    320000   304.17163     -13245.552     -14805.745     -15086.986     -14547.611     -14627.535     -4.5382339     -3.3849102     -2865.1083    
    480000   298.04336     -13249.147     -15156.294     -15084.37      -14544.503     -14628.022      0.40232461    -0.44567325    -2861.3332    
Loop time of 755.804 on 30 procs for 480000 steps with 4000 atoms

Performance: 54.871 ns/day, 0.437 hours/ns, 635.085 timesteps/s, 2.540 Matom-step/s
91.8% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 639.29     | 680.27     | 697.65     |  54.4 | 90.01
Neigh   | 0.79044    | 0.87464    | 0.95087    |   6.5 |  0.12
Comm    | 42.407     | 60.451     | 101.43     | 191.5 |  8.00
Output  | 0.00012601 | 0.00014112 | 0.0001913  |   0.0 |  0.00
Modify  | 3.2841     | 3.5475     | 3.7377     |   8.3 |  0.47
Other   |            | 10.66      |            |       |  1.41

Nlocal:        133.333 ave         144 max         117 min
Histogram: 4 4 2 0 0 0 0 5 10 5
Nghost:          817.9 ave         848 max         781 min
Histogram: 8 2 0 0 0 0 5 5 6 4
Neighs:         3539.1 ave        3815 max        3092 min
Histogram: 4 3 3 0 0 0 0 5 9 6
FullNghs:       7078.2 ave        7660 max        6235 min
Histogram: 5 4 1 0 0 0 0 5 10 5

Total # of neighbors = 212346
Ave neighs/atom = 53.0865
Neighbor list builds = 2467
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -0.18846544432201
variable C2pos equal ${d2}
variable C2pos equal -1.14926180291501
variable C3pos equal ${d3}
variable C3pos equal -1.59522726917099
variable C4pos equal ${d4}
variable C4pos equal 28.6271573988253
variable C5pos equal ${d5}
variable C5pos equal -0.0539368697497053
variable C6pos equal ${d6}
variable C6pos equal 0.0646528623337976

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(${C1neg}+${C1pos})
variable C14 equal 0.5*(0.155168350825006+${C1pos})
variable C14 equal 0.5*(0.155168350825006+-0.18846544432201)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(${C2neg}+${C2pos})
variable C24 equal 0.5*(1.21151589396701+${C2pos})
variable C24 equal 0.5*(1.21151589396701+-1.14926180291501)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(${C3neg}+${C3pos})
variable C34 equal 0.5*(1.64302246274099+${C3pos})
variable C34 equal 0.5*(1.64302246274099+-1.59522726917099)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(${C4neg}+${C4pos})
variable C44 equal 0.5*(28.6488373655892+${C4pos})
variable C44 equal 0.5*(28.6488373655892+28.6271573988253)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(${C5neg}+${C5pos})
variable C54 equal 0.5*(-0.000740866241191194+${C5pos})
variable C54 equal 0.5*(-0.000740866241191194+-0.0539368697497053)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(${C6neg}+${C6pos})
variable C64 equal 0.5*(-0.0727818959532374+${C6pos})
variable C64 equal 0.5*(-0.0727818959532374+0.0646528623337976)

# Delete dir to make sure it is not reused

variable dir delete

# uxz Perturbation

variable dir equal 5
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
variable len0 equal ${lz0}
variable len0 equal 41.1736635304057
if "${dir} == 6" then    "variable len0 equal ${ly0}"

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.009 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.1736635304057
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta -0.411736635304057 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 -0.41173664 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.82 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13245.818     -14797.174      0              0              0              0              0              0            
    160000   298.75985     -13245.572     -14848.209     -14979.826     -14643.335     -14632.423     -0.40578917     2830.2596     -4.1434047    
    320000   295.22931     -13244.101     -14702.955     -14981.058     -14652.549     -14631.614      8.8784276      2833.6998     -7.1138199    
    480000   298.82399     -13243.549     -14637.939     -14972.987     -14644.647     -14612.54      -1.9062082      2836.3999      5.2987668    
    640000   308.4325      -13244.119     -14641.531     -14977.814     -14632.034     -14617.707     -3.6172988      2820.1085      4.0286167    
    800000   306.04643     -13248.392     -15047.863     -14978.641     -14659.702     -14635.2        3.4901049      2827.4653      4.0615395    
    960000   304.85146     -13247.049     -14848.21      -14967.203     -14654.8       -14622.658      7.8790603      2830.5931      12.203522    
   1120000   301.16614     -13244.081     -14739.108     -14980.91      -14664.111     -14625.516      1.0064115      2833.6897      13.989987    
   1280000   305.10939     -13247.416     -14960.966     -14978.955     -14661.961     -14620.123      10.388856      2830.7262     -2.7780931    
   1440000   301.31289     -13245.266     -14766.879     -15004.841     -14660.765     -14635.144     -4.3156377      2811.5225      0.53158872   
   1600000   295.02189     -13244.04      -14625.288     -14979.343     -14646.134     -14616.112     -3.0600183      2836.7989      4.6070045    
Loop time of 2896.28 on 30 procs for 1600000 steps with 4000 atoms

Performance: 47.730 ns/day, 0.503 hours/ns, 552.432 timesteps/s, 2.210 Matom-step/s
91.1% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2423.3     | 2581.8     | 2669.6     | 119.3 | 89.14
Neigh   | 2.739      | 2.9447     | 3.1987     |  10.7 |  0.10
Comm    | 174.24     | 260.44     | 425.15     | 405.6 |  8.99
Output  | 0.00045118 | 0.00052941 | 0.00068804 |   0.0 |  0.00
Modify  | 11.307     | 12.02      | 12.627     |  12.1 |  0.42
Other   |            | 39.07      |            |       |  1.35

Nlocal:        133.333 ave         146 max         118 min
Histogram: 1 0 2 5 4 7 2 6 0 3
Nghost:          772.8 ave         823 max         737 min
Histogram: 6 6 6 1 1 0 0 2 3 5
Neighs:        3540.53 ave        3919 max        3158 min
Histogram: 1 1 4 2 6 9 1 3 0 3
FullNghs:      7081.07 ave        7744 max        6268 min
Histogram: 1 0 3 4 4 7 2 6 0 3

Total # of neighbors = 212432
Ave neighs/atom = 53.108
Neighbor list builds = 8222
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.826 | 8.833 | 8.84 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   295.02189     -13244.04      -14625.288      0              0              0              0              0              0            
    160000   301.8543      -13247.397     -14944.209     -14986.242     -14666.494     -14624.373      4.4023721      2824.3856      18.319226    
    320000   300.04639     -13241.039     -14433.345     -14975.42      -14644.278     -14640.578     -6.5474372      2839.8983      8.5867216    
    480000   298.02365     -13243.147     -14659.123     -14980.77      -14649.318     -14616.9       -8.3306552      2825.6319     -0.70205453   
Loop time of 855.657 on 30 procs for 480000 steps with 4000 atoms

Performance: 48.468 ns/day, 0.495 hours/ns, 560.972 timesteps/s, 2.244 Matom-step/s
91.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 730.2      | 772.87     | 796.04     |  56.6 | 90.32
Neigh   | 0.83036    | 0.9479     | 1.0718     |   7.5 |  0.11
Comm    | 44.453     | 66.968     | 106.99     | 176.3 |  7.83
Output  | 0.00012477 | 0.00014504 | 0.00019817 |   0.0 |  0.00
Modify  | 3.4687     | 3.8678     | 4.2637     |  10.9 |  0.45
Other   |            | 11.01      |            |       |  1.29

Nlocal:        133.333 ave         142 max         116 min
Histogram: 1 8 0 1 0 0 0 0 6 14
Nghost:        819.367 ave         852 max         780 min
Histogram: 5 4 1 0 0 4 3 4 5 4
Neighs:        3538.43 ave        3818 max        3042 min
Histogram: 1 4 4 1 0 0 0 4 9 7
FullNghs:      7076.87 ave        7553 max        6122 min
Histogram: 1 5 3 1 0 0 0 1 7 12

Total # of neighbors = 212306
Ave neighs/atom = 53.0765
Neighbor list builds = 2463
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 1.22446042801601
variable C2neg equal ${d2}
variable C2neg equal 0.101110566464013
variable C3neg equal ${d3}
variable C3neg equal 1.70645299465399
variable C4neg equal ${d4}
variable C4neg equal -0.0208455078714848
variable C5neg equal ${d5}
variable C5neg equal 28.3147121439469
variable C6neg equal ${d6}
variable C6neg equal -0.151982660270856

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.016 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.1736635304057
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
change_box all xz delta ${delta} remap units box
change_box all xz delta 0.411736635304057 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0.41173664 0)
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.82 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13245.951     -14811.549      0              0              0              0              0              0            
    160000   297.56008     -13245.03      -14772.832     -14982.699     -14653.661     -14621.656      2.6224625     -2823.7867      4.3532687    
    320000   301.97738     -13246.232     -14867.685     -14965.908     -14649.304     -14626.148      1.7735186     -2831.3975      2.547104     
    480000   294.75712     -13244.895     -14760.273     -14973.63      -14642.491     -14610.624     -2.8544216     -2823.0402      15.224503    
    640000   305.16728     -13245.159     -14751.336     -14985.066     -14659.692     -14624.797     -5.9390036     -2841.2239      14.97439     
    800000   305.75389     -13245.023     -14709.967     -14951.542     -14645.327     -14610.285     -9.0859976     -2838.7424     -5.7930227    
    960000   303.81033     -13244.446     -14657.162     -14995.538     -14655.716     -14629.912     -7.3682097     -2816.152      -1.6404144    
   1120000   301.49959     -13245.656     -14817.961     -14984.931     -14658.17      -14620.962     -12.030193     -2838.3041     -2.0609827    
   1280000   303.57644     -13242.423     -14433.939     -14990.565     -14653.797     -14627.433     -0.69934499    -2833.0001      0.067788347  
   1440000   303.43298     -13245.651     -14785.829     -14986.389     -14663.839     -14650.836     -5.3633712     -2831.2962      4.2017311    
   1600000   310.08187     -13249.216     -15051.672     -14995.041     -14657.657     -14645.973     -0.56647487    -2836.6585     -11.857466    
Loop time of 2662.44 on 30 procs for 1600000 steps with 4000 atoms

Performance: 51.922 ns/day, 0.462 hours/ns, 600.953 timesteps/s, 2.404 Matom-step/s
91.8% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2299.3     | 2427.1     | 2503.4     |  92.9 | 91.16
Neigh   | 2.8518     | 3.1784     | 3.5996     |  12.6 |  0.12
Comm    | 119.28     | 190.49     | 312.79     | 324.6 |  7.15
Output  | 0.00043335 | 0.00049671 | 0.00063303 |   0.0 |  0.00
Modify  | 11.903     | 12.979     | 14.24      |  17.9 |  0.49
Other   |            | 28.64      |            |       |  1.08

Nlocal:        133.333 ave         143 max         126 min
Histogram: 6 5 1 2 4 2 0 4 4 2
Nghost:        771.167 ave         823 max         735 min
Histogram: 2 9 7 2 0 0 0 4 2 4
Neighs:        3540.37 ave        3816 max        3332 min
Histogram: 4 5 5 3 1 4 2 1 1 4
FullNghs:      7080.73 ave        7626 max        6698 min
Histogram: 7 4 1 4 4 0 3 2 3 2

Total # of neighbors = 212422
Ave neighs/atom = 53.1055
Neighbor list builds = 8207
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.827 | 8.833 | 8.839 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   310.08187     -13249.216     -15051.672      0              0              0              0              0              0            
    160000   301.65461     -13248.236     -15018.625     -14993.697     -14649.916     -14637.742      7.5033509     -2839.9928     -4.9568748    
    320000   300.58966     -13245.204     -14784.554     -14988.769     -14668.638     -14642.754     -0.68616749    -2802.8855      14.740433    
    480000   298.9192      -13241.128     -14452.902     -14969.374     -14633.933     -14617.496     -18.147007     -2818.5505     -3.937643     
Loop time of 790.609 on 30 procs for 480000 steps with 4000 atoms

Performance: 52.456 ns/day, 0.458 hours/ns, 607.127 timesteps/s, 2.429 Matom-step/s
91.8% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 681.13     | 722.14     | 745.71     |  55.2 | 91.34
Neigh   | 0.84408    | 0.96236    | 1.0975     |   7.6 |  0.12
Comm    | 33.689     | 55.546     | 94.575     | 188.7 |  7.03
Output  | 0.00012367 | 0.0001567  | 0.00020376 |   0.0 |  0.00
Modify  | 3.5028     | 3.8838     | 4.3969     |  11.3 |  0.49
Other   |            | 8.082      |            |       |  1.02

Nlocal:        133.333 ave         143 max         117 min
Histogram: 4 3 3 0 0 0 0 3 10 7
Nghost:        815.767 ave         847 max         778 min
Histogram: 6 3 1 0 0 4 4 2 4 6
Neighs:        3539.57 ave        3832 max        3090 min
Histogram: 3 4 3 0 0 0 2 7 5 6
FullNghs:      7079.13 ave        7609 max        6234 min
Histogram: 4 3 3 0 0 0 0 4 10 6

Total # of neighbors = 212374
Ave neighs/atom = 53.0935
Neighbor list builds = 2484
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -1.33842678392801
variable C2pos equal ${d2}
variable C2pos equal -0.25496969350701
variable C3pos equal ${d3}
variable C3pos equal -1.70049162236199
variable C4pos equal ${d4}
variable C4pos equal 0.0532013929555778
variable C5pos equal ${d5}
variable C5pos equal 28.1271111808779
variable C6pos equal ${d6}
variable C6pos equal 0.250146178014106

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(${C1neg}+${C1pos})
variable C15 equal 0.5*(1.22446042801601+${C1pos})
variable C15 equal 0.5*(1.22446042801601+-1.33842678392801)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(${C2neg}+${C2pos})
variable C25 equal 0.5*(0.101110566464013+${C2pos})
variable C25 equal 0.5*(0.101110566464013+-0.25496969350701)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(${C3neg}+${C3pos})
variable C35 equal 0.5*(1.70645299465399+${C3pos})
variable C35 equal 0.5*(1.70645299465399+-1.70049162236199)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(${C4neg}+${C4pos})
variable C45 equal 0.5*(-0.0208455078714848+${C4pos})
variable C45 equal 0.5*(-0.0208455078714848+0.0532013929555778)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(${C5neg}+${C5pos})
variable C55 equal 0.5*(28.3147121439469+${C5pos})
variable C55 equal 0.5*(28.3147121439469+28.1271111808779)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(${C6neg}+${C6pos})
variable C65 equal 0.5*(-0.151982660270856+${C6pos})
variable C65 equal 0.5*(-0.151982660270856+0.250146178014106)

# Delete dir to make sure it is not reused

variable dir delete

# uxy Perturbation

variable dir equal 6
include displace.mod
# NOTE: This script should not need to be
# modified. See in.elastic for more info.
#
# Find which reference length to use

if "${dir} == 1" then    "variable len0 equal ${lx0}"
if "${dir} == 2" then    "variable len0 equal ${ly0}"
if "${dir} == 3" then    "variable len0 equal ${lz0}"
if "${dir} == 4" then    "variable len0 equal ${lz0}"
if "${dir} == 5" then    "variable len0 equal ${lz0}"
if "${dir} == 6" then    "variable len0 equal ${ly0}"
variable len0 equal ${ly0}
variable len0 equal 41.1600464347122

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.009 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Negative deformation

variable delta equal -${up}*${len0}
variable delta equal -0.01*${len0}
variable delta equal -0.01*41.1600464347122
variable deltaxy equal -${up}*xy
variable deltaxy equal -0.01*xy
variable deltaxz equal -${up}*xz
variable deltaxz equal -0.01*xz
variable deltayz equal -${up}*yz
variable deltayz equal -0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta -0.411600464347122 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (-0.41160046 0 0)

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.82 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13245.855     -14800.85       0              0              0              0              0              0            
    160000   299.57101     -13246.868     -14921.251     -14993.736     -14507.705     -14797.276      2839.4689     -8.6042855      6.6375465    
    320000   300.12668     -13247.293     -14925.626     -14958.786     -14506.281     -14783.603      2847.3744      3.8122653     -0.75481557   
    480000   296.9598      -13244.924     -14810.745     -14965.917     -14519.966     -14767.523      2835.8361     -0.41350481    -3.1680415    
    640000   289.06736     -13244.551     -14728.816     -14967.113     -14500.413     -14761.052      2847.971       14.385422     -11.024671    
    800000   302.97929     -13242.982     -14515.375     -14973.477     -14493.003     -14770.944      2836.9756      4.9842793     -15.297668    
    960000   300.3489      -13249.265     -15119.164     -14979.299     -14503.246     -14784.832      2838.794       2.1224744      12.838603    
   1120000   303.05345     -13247.411     -14965.104     -14982.008     -14495.073     -14776.848      2844.1711      5.8219948     -1.154284     
   1280000   293.63218     -13245.894     -14837.361     -14993.389     -14532.714     -14788.579      2838.2567     -8.7934284     -4.3633639    
   1440000   297.07643     -13242.516     -14584.055     -14969.594     -14484.313     -14780.904      2849.4084      1.7855281      8.0624673    
   1600000   303.59385     -13242.796     -14566.594     -14962.246     -14487.473     -14751.21       2848.2146     -2.0448776     -5.5584897    
Loop time of 2577.53 on 30 procs for 1600000 steps with 4000 atoms

Performance: 53.633 ns/day, 0.447 hours/ns, 620.750 timesteps/s, 2.483 Matom-step/s
91.9% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2261       | 2354       | 2424.3     |  76.1 | 91.33
Neigh   | 2.8281     | 3.1593     | 3.5955     |  12.8 |  0.12
Comm    | 112.25     | 180.07     | 271.31     | 273.5 |  6.99
Output  | 0.00044748 | 0.00051934 | 0.00068518 |   0.0 |  0.00
Modify  | 11.727     | 12.89      | 14.647     |  19.5 |  0.50
Other   |            | 27.42      |            |       |  1.06

Nlocal:        133.333 ave         143 max         123 min
Histogram: 4 2 3 2 1 4 2 6 2 4
Nghost:        767.767 ave         820 max         727 min
Histogram: 1 8 10 1 0 0 0 1 4 5
Neighs:        3541.77 ave        3791 max        3226 min
Histogram: 2 3 4 0 2 5 1 3 7 3
FullNghs:      7083.53 ave        7596 max        6507 min
Histogram: 4 2 3 2 2 3 2 6 3 3

Total # of neighbors = 212506
Ave neighs/atom = 53.1265
Neighbor list builds = 8222
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.825 | 8.833 | 8.84 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   303.59385     -13242.796     -14566.594      0              0              0              0              0              0            
    160000   298.8672      -13241.024     -14427.344     -14974.369     -14510.196     -14763.528      2838.2023      0.93029522     2.3798747    
    320000   302.86471     -13245.413     -14773.364     -14978.331     -14507.106     -14793.209      2848.4078      2.8291198      14.098877    
    480000   305.53584     -13242.405     -14488.016     -14982.4       -14514.087     -14775.605      2837.2355     -11.035599      10.822986    
Loop time of 765.193 on 30 procs for 480000 steps with 4000 atoms

Performance: 54.198 ns/day, 0.443 hours/ns, 627.292 timesteps/s, 2.509 Matom-step/s
92.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 663.61     | 698.89     | 720.68     |  51.7 | 91.34
Neigh   | 0.83375    | 0.95681    | 1.0941     |   7.9 |  0.13
Comm    | 32.985     | 53.394     | 86.866     | 180.3 |  6.98
Output  | 0.00012851 | 0.00015001 | 0.00018938 |   0.0 |  0.00
Modify  | 3.4662     | 3.8897     | 4.3989     |  12.1 |  0.51
Other   |            | 8.059      |            |       |  1.05

Nlocal:        133.333 ave         142 max         115 min
Histogram: 2 3 3 2 0 0 0 0 7 13
Nghost:        815.433 ave         852 max         775 min
Histogram: 5 5 0 0 0 4 5 2 6 3
Neighs:         3541.4 ave        3850 max        3008 min
Histogram: 1 2 5 2 0 0 0 5 12 3
FullNghs:       7082.8 ave        7566 max        6110 min
Histogram: 2 3 3 2 0 0 0 0 8 12

Total # of neighbors = 212484
Ave neighs/atom = 53.121
Neighbor list builds = 2467
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1neg equal ${d1}
variable C1neg equal 1.20816559400701
variable C2neg equal ${d2}
variable C2neg equal 1.453427179753
variable C3neg equal ${d3}
variable C3neg equal 0.119404693348988
variable C4neg equal ${d4}
variable C4neg equal 0.0944048967836808
variable C5neg equal ${d5}
variable C5neg equal -0.0519623899590788
variable C6neg equal ${d6}
variable C6neg equal 28.3036792031654

# Reset box and simulation parameters

clear
  using 1 OpenMP thread(s) per MPI task
box tilt large

The 'box' command has been removed and will be ignored

read_restart restart.equil
Reading restart file ...
  restart file = 22 Jul 2025, LAMMPS = 22 Jul 2025
  restoring atom style atomic from restart
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0 0 0)
  5 by 2 by 3 MPI processor grid
  pair style meam stores no restart info
  4000 atoms
  read_restart CPU = 0.017 seconds
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457



# Positive deformation

variable delta equal ${up}*${len0}
variable delta equal 0.01*${len0}
variable delta equal 0.01*41.1600464347122
variable deltaxy equal ${up}*xy
variable deltaxy equal 0.01*xy
variable deltaxz equal ${up}*xz
variable deltaxz equal 0.01*xz
variable deltayz equal ${up}*yz
variable deltayz equal 0.01*yz
if "${dir} == 1" then    "change_box all x delta 0 ${delta} xy delta ${deltaxy} xz delta ${deltaxz} remap units box"
if "${dir} == 2" then    "change_box all y delta 0 ${delta} yz delta ${deltayz} remap units box"
if "${dir} == 3" then    "change_box all z delta 0 ${delta} remap units box"
if "${dir} == 4" then    "change_box all yz delta ${delta} remap units box"
if "${dir} == 5" then    "change_box all xz delta ${delta} remap units box"
if "${dir} == 6" then    "change_box all xy delta ${delta} remap units box"
change_box all xy delta ${delta} remap units box
change_box all xy delta 0.411600464347122 remap units box
Changing box ...
  triclinic box = (-0.35439391 -0.33002322 -0.33683177) to (40.854394 40.830023 40.836832) with tilt (0.41160046 0 0)

# Run MD

run ${nequil}
run 1600000
Neighbor list info ...
  update: every = 1 steps, delay = 0 steps, check = yes
  max neighbors/atom: 2000, page size: 100000
  master list distance cutoff = 6
  ghost atom cutoff = 6
  2 neighbor lists, perpetual/occasional/extra = 2 0 0
  (1) pair meam, perpetual
      attributes: full, newton on
      pair build: full/nsq
      stencil: none
      bin: none
  (2) pair meam, perpetual, half/full from (1)
      attributes: half, newton on
      pair build: halffull/newton/tri
      stencil: none
      bin: none
Per MPI rank memory allocation (min/avg/max) = 8.808 | 8.82 | 8.829 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   307.06101     -13245.91      -14807.893      0              0              0              0              0              0            
    160000   297.00565     -13245.077     -14765.194     -14957.9       -14486.738     -14755.325     -2839.961      -3.0944578      11.704742    
    320000   293.276       -13246.953     -14947.316     -14970.666     -14511.585     -14779.358     -2829.2235      4.2568798      15.603219    
    480000   300.65811     -13245.408     -14841.602     -14965.073     -14496.652     -14767.751     -2843.5881     -5.7703072     -6.3058652    
    640000   306.01864     -13244.585     -14698.814     -14960.72      -14490.258     -14761.942     -2832.3734      15.634137      12.156131    
    800000   293.7883      -13248.756     -15121.345     -14983.076     -14496.416     -14778.035     -2842.0319     -12.36245       9.177288     
    960000   304.4699      -13247.793     -15007.797     -14997.825     -14519.303     -14775.675     -2844.2311      0.35945485     3.9655024    
   1120000   300.81879     -13245.451     -14805.235     -14985.256     -14495.119     -14783.323     -2850.1924     -3.9840708     -12.157912    
   1280000   297.97148     -13245.144     -14740.815     -14970.524     -14499.112     -14768.656     -2838.0782      14.377945      2.9158106    
   1440000   299.81959     -13243.835     -14718.689     -14959.956     -14487.466     -14768.923     -2838.7329      1.8410799     -1.6582533    
   1600000   296.14957     -13242.457     -14529.226     -14984.909     -14497.681     -14770.512     -2847.8277      8.0420078      2.66517      
Loop time of 2591.03 on 30 procs for 1600000 steps with 4000 atoms

Performance: 53.353 ns/day, 0.450 hours/ns, 617.514 timesteps/s, 2.470 Matom-step/s
92.1% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 2229.4     | 2359.7     | 2443.2     | 101.6 | 91.07
Neigh   | 2.846      | 3.1706     | 3.6162     |  12.8 |  0.12
Comm    | 109.32     | 187.03     | 307.86     | 350.7 |  7.22
Output  | 0.00045156 | 0.00050405 | 0.00068045 |   0.0 |  0.00
Modify  | 11.729     | 12.897     | 14.771     |  20.0 |  0.50
Other   |            | 28.23      |            |       |  1.09

Nlocal:        133.333 ave         143 max         124 min
Histogram: 3 3 1 8 1 2 3 3 4 2
Nghost:        769.233 ave         823 max         730 min
Histogram: 4 6 9 1 0 0 0 1 5 4
Neighs:        3540.23 ave        3779 max        3210 min
Histogram: 1 3 2 1 5 4 3 3 2 6
FullNghs:      7080.47 ave        7579 max        6596 min
Histogram: 6 1 0 8 1 2 1 4 3 4

Total # of neighbors = 212414
Ave neighs/atom = 53.1035
Neighbor list builds = 8228
Dangerous builds = 0
include potential.mod
# NOTE: This script can be modified for different pair styles
# See in.elastic for more info.

# we must undefine any fix ave/* fix before using reset_timestep
if "$(is_defined(fix,avp))" then "unfix avp"
unfix avp
reset_timestep 0

# Choose potential

pair_style  meam
pair_coeff * * library-Al.meam Al Al.meam Al



# Setup neighbor style
neighbor 1.0 nsq
neigh_modify once no every 1 delay 0 check yes

# Setup output

fix avp all ave/time  ${nevery} ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 ${nrepeat} ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 ${nfreq} c_thermo_press mode vector
fix avp all ave/time  400 400 160000 c_thermo_press mode vector
thermo		${nthermo}
thermo		160000
thermo_style custom step temp pe press f_avp[1] f_avp[2] f_avp[3] f_avp[4] f_avp[5] f_avp[6]
WARNING: New thermo_style command, previous thermo_modify settings will be lost (src/output.cpp:912)
thermo_modify norm no

# Setup MD

timestep ${timestep}
timestep 0.001
fix 4 all nve
if "${thermostat} == 1" then    "fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}"
fix 5 all langevin ${temp} ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 ${temp} ${tdamp} ${seed}
fix 5 all langevin 300 300 ${tdamp} ${seed}
fix 5 all langevin 300 300 0.01 ${seed}
fix 5 all langevin 300 300 0.01 123457


run ${nrun}
run 480000
Per MPI rank memory allocation (min/avg/max) = 8.825 | 8.833 | 8.839 Mbytes
   Step          Temp          PotEng         Press         f_avp[1]       f_avp[2]       f_avp[3]       f_avp[4]       f_avp[5]       f_avp[6]   
         0   296.14957     -13242.457     -14529.226      0              0              0              0              0              0            
    160000   301.70303     -13245.855     -14816.141     -14996.193     -14512.348     -14782.809     -2832.7734      2.7556748     -17.122624    
    320000   299.45189     -13244.813     -14768.44      -14967.411     -14488.707     -14780.466     -2845.4264      13.173066     -17.34118     
    480000   299.73911     -13245.365     -14762.446     -14971.894     -14504.536     -14761.494     -2850.4592      0.82419746     21.333878    
Loop time of 766.162 on 30 procs for 480000 steps with 4000 atoms

Performance: 54.130 ns/day, 0.443 hours/ns, 626.499 timesteps/s, 2.506 Matom-step/s
92.2% CPU use with 30 MPI tasks x 1 OpenMP threads

MPI task timing breakdown:
Section |  min time  |  avg time  |  max time  |%varavg| %total
---------------------------------------------------------------
Pair    | 660.82     | 698.97     | 722.61     |  53.9 | 91.23
Neigh   | 0.83707    | 0.95664    | 1.0922     |   7.7 |  0.12
Comm    | 32.081     | 54.216     | 89.889     | 185.8 |  7.08
Output  | 0.0001314  | 0.00014594 | 0.00018994 |   0.0 |  0.00
Modify  | 3.4722     | 3.8828     | 4.4539     |  12.2 |  0.51
Other   |            | 8.134      |            |       |  1.06

Nlocal:        133.333 ave         143 max         117 min
Histogram: 5 2 3 0 0 0 0 4 7 9
Nghost:        816.433 ave         851 max         770 min
Histogram: 1 5 4 0 1 1 4 5 4 5
Neighs:        3540.87 ave        3820 max        3092 min
Histogram: 5 3 2 0 0 0 1 3 9 7
FullNghs:      7081.73 ave        7615 max        6190 min
Histogram: 4 2 4 0 0 0 1 4 7 8

Total # of neighbors = 212452
Ave neighs/atom = 53.113
Neighbor list builds = 2470
Dangerous builds = 0

# Obtain new stress tensor

variable pxx1 equal f_avp[1]
variable pyy1 equal f_avp[2]
variable pzz1 equal f_avp[3]
variable pxy1 equal f_avp[4]
variable pxz1 equal f_avp[5]
variable pyz1 equal f_avp[6]

# Compute elastic constant from pressure tensor

variable C1pos equal ${d1}
variable C1pos equal -1.31322680084
variable C2pos equal ${d2}
variable C2pos equal -1.548932154225
variable C3pos equal ${d3}
variable C3pos equal -0.260510657431987
variable C4pos equal ${d4}
variable C4pos equal -0.199513813802269
variable C5pos equal ${d5}
variable C5pos equal -0.0666355768601585
variable C6pos equal ${d6}
variable C6pos equal 28.5732684917576

# Combine positive and negative

variable C1${dir} equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(${C1neg}+${C1pos})
variable C16 equal 0.5*(1.20816559400701+${C1pos})
variable C16 equal 0.5*(1.20816559400701+-1.31322680084)
variable C2${dir} equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(${C2neg}+${C2pos})
variable C26 equal 0.5*(1.453427179753+${C2pos})
variable C26 equal 0.5*(1.453427179753+-1.548932154225)
variable C3${dir} equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(${C3neg}+${C3pos})
variable C36 equal 0.5*(0.119404693348988+${C3pos})
variable C36 equal 0.5*(0.119404693348988+-0.260510657431987)
variable C4${dir} equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(${C4neg}+${C4pos})
variable C46 equal 0.5*(0.0944048967836808+${C4pos})
variable C46 equal 0.5*(0.0944048967836808+-0.199513813802269)
variable C5${dir} equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(${C5neg}+${C5pos})
variable C56 equal 0.5*(-0.0519623899590788+${C5pos})
variable C56 equal 0.5*(-0.0519623899590788+-0.0666355768601585)
variable C6${dir} equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(${C6neg}+${C6pos})
variable C66 equal 0.5*(28.3036792031654+${C6pos})
variable C66 equal 0.5*(28.3036792031654+28.5732684917576)

# Delete dir to make sure it is not reused

variable dir delete

# Output final values

variable C11all equal ${C11}
variable C11all equal 74.3117528947114
variable C22all equal ${C22}
variable C22all equal 74.5870086235088
variable C33all equal ${C33}
variable C33all equal 74.4824228119534

variable C12all equal 0.5*(${C12}+${C21})
variable C12all equal 0.5*(37.4742040560705+${C21})
variable C12all equal 0.5*(37.4742040560705+37.4833412616725)
variable C13all equal 0.5*(${C13}+${C31})
variable C13all equal 0.5*(37.3631490434075+${C31})
variable C13all equal 0.5*(37.3631490434075+37.2493299984195)
variable C23all equal 0.5*(${C23}+${C32})
variable C23all equal 0.5*(37.8437787856855+${C32})
variable C23all equal 0.5*(37.8437787856855+37.7977138231575)

variable C44all equal ${C44}
variable C44all equal 28.6379973822072
variable C55all equal ${C55}
variable C55all equal 28.2209116624124
variable C66all equal ${C66}
variable C66all equal 28.4384738474615

variable C14all equal 0.5*(${C14}+${C41})
variable C14all equal 0.5*(-0.016648546748502+${C41})
variable C14all equal 0.5*(-0.016648546748502+0.0361538964265057)
variable C15all equal 0.5*(${C15}+${C51})
variable C15all equal 0.5*(-0.0569831779559999+${C51})
variable C15all equal 0.5*(-0.0569831779559999+-0.0096570928068933)
variable C16all equal 0.5*(${C16}+${C61})
variable C16all equal 0.5*(-0.0525306034164951+${C61})
variable C16all equal 0.5*(-0.0525306034164951+-0.0461849452446397)

variable C24all equal 0.5*(${C24}+${C42})
variable C24all equal 0.5*(0.0311270455260001+${C42})
variable C24all equal 0.5*(0.0311270455260001+-0.0213790060994636)
variable C25all equal 0.5*(${C25}+${C52})
variable C25all equal 0.5*(-0.0769295635214985+${C52})
variable C25all equal 0.5*(-0.0769295635214985+-0.0437476736387113)
variable C26all equal 0.5*(${C26}+${C62})
variable C26all equal 0.5*(-0.047752487236+${C62})
variable C26all equal 0.5*(-0.047752487236+0.0422422118295365)

variable C34all equal 0.5*(${C34}+${C43})
variable C34all equal 0.5*(0.023897596785+${C43})
variable C34all equal 0.5*(0.023897596785+0.0580579678169202)
variable C35all equal 0.5*(${C35}+${C53})
variable C35all equal 0.5*(0.002980686146+${C53})
variable C35all equal 0.5*(0.002980686146+-0.0206990322843047)
variable C36all equal 0.5*(${C36}+${C63})
variable C36all equal 0.5*(-0.0705529820414995+${C63})
variable C36all equal 0.5*(-0.0705529820414995+0.025598684926273)

variable C45all equal 0.5*(${C45}+${C54})
variable C45all equal 0.5*(0.0161779425420465+${C54})
variable C45all equal 0.5*(0.0161779425420465+-0.0273388679954482)
variable C46all equal 0.5*(${C46}+${C64})
variable C46all equal 0.5*(-0.0525544585092941+${C64})
variable C46all equal 0.5*(-0.0525544585092941+-0.0040645168097199)
variable C56all equal 0.5*(${C56}+${C65})
variable C56all equal 0.5*(-0.0592989834096187+${C65})
variable C56all equal 0.5*(-0.0592989834096187+0.049081758871625)

# Average moduli for cubic crystals

variable C11cubic equal (${C11all}+${C22all}+${C33all})/3.0
variable C11cubic equal (74.3117528947114+${C22all}+${C33all})/3.0
variable C11cubic equal (74.3117528947114+74.5870086235088+${C33all})/3.0
variable C11cubic equal (74.3117528947114+74.5870086235088+74.4824228119534)/3.0
variable C12cubic equal (${C12all}+${C13all}+${C23all})/3.0
variable C12cubic equal (37.4787726588715+${C13all}+${C23all})/3.0
variable C12cubic equal (37.4787726588715+37.3062395209135+${C23all})/3.0
variable C12cubic equal (37.4787726588715+37.3062395209135+37.8207463044215)/3.0
variable C44cubic equal (${C44all}+${C55all}+${C66all})/3.0
variable C44cubic equal (28.6379973822072+${C55all}+${C66all})/3.0
variable C44cubic equal (28.6379973822072+28.2209116624124+${C66all})/3.0
variable C44cubic equal (28.6379973822072+28.2209116624124+28.4384738474615)/3.0

variable bulkmodulus equal (${C11cubic}+2*${C12cubic})/3.0
variable bulkmodulus equal (74.4603947767245+2*${C12cubic})/3.0
variable bulkmodulus equal (74.4603947767245+2*37.5352528280688)/3.0
variable shearmodulus1 equal ${C44cubic}
variable shearmodulus1 equal 28.432460964027
variable shearmodulus2 equal (${C11cubic}-${C12cubic})/2.0
variable shearmodulus2 equal (74.4603947767245-${C12cubic})/2.0
variable shearmodulus2 equal (74.4603947767245-37.5352528280688)/2.0
variable poissonratio equal 1.0/(1.0+${C11cubic}/${C12cubic})
variable poissonratio equal 1.0/(1.0+74.4603947767245/${C12cubic})
variable poissonratio equal 1.0/(1.0+74.4603947767245/37.5352528280688)

# For Stillinger-Weber silicon, the analytical results
# are known to be (E. R. Cowley, 1988):
#               C11 = 151.4 GPa
#               C12 = 76.4 GPa
#               C44 = 56.4 GPa

print "========================================="
=========================================
print "Components of the Elastic Constant Tensor"
Components of the Elastic Constant Tensor
print "========================================="
=========================================

print "Elastic Constant C11all = ${C11all} ${cunits}"
Elastic Constant C11all = 74.3117528947114 GPa
print "Elastic Constant C22all = ${C22all} ${cunits}"
Elastic Constant C22all = 74.5870086235088 GPa
print "Elastic Constant C33all = ${C33all} ${cunits}"
Elastic Constant C33all = 74.4824228119534 GPa

print "Elastic Constant C12all = ${C12all} ${cunits}"
Elastic Constant C12all = 37.4787726588715 GPa
print "Elastic Constant C13all = ${C13all} ${cunits}"
Elastic Constant C13all = 37.3062395209135 GPa
print "Elastic Constant C23all = ${C23all} ${cunits}"
Elastic Constant C23all = 37.8207463044215 GPa

print "Elastic Constant C44all = ${C44all} ${cunits}"
Elastic Constant C44all = 28.6379973822072 GPa
print "Elastic Constant C55all = ${C55all} ${cunits}"
Elastic Constant C55all = 28.2209116624124 GPa
print "Elastic Constant C66all = ${C66all} ${cunits}"
Elastic Constant C66all = 28.4384738474615 GPa

print "Elastic Constant C14all = ${C14all} ${cunits}"
Elastic Constant C14all = 0.00975267483900185 GPa
print "Elastic Constant C15all = ${C15all} ${cunits}"
Elastic Constant C15all = -0.0333201353814466 GPa
print "Elastic Constant C16all = ${C16all} ${cunits}"
Elastic Constant C16all = -0.0493577743305674 GPa

print "Elastic Constant C24all = ${C24all} ${cunits}"
Elastic Constant C24all = 0.00487401971326825 GPa
print "Elastic Constant C25all = ${C25all} ${cunits}"
Elastic Constant C25all = -0.0603386185801049 GPa
print "Elastic Constant C26all = ${C26all} ${cunits}"
Elastic Constant C26all = -0.00275513770323175 GPa

print "Elastic Constant C34all = ${C34all} ${cunits}"
Elastic Constant C34all = 0.0409777823009601 GPa
print "Elastic Constant C35all = ${C35all} ${cunits}"
Elastic Constant C35all = -0.00885917306915235 GPa
print "Elastic Constant C36all = ${C36all} ${cunits}"
Elastic Constant C36all = -0.0224771485576132 GPa

print "Elastic Constant C45all = ${C45all} ${cunits}"
Elastic Constant C45all = -0.00558046272670085 GPa
print "Elastic Constant C46all = ${C46all} ${cunits}"
Elastic Constant C46all = -0.028309487659507 GPa
print "Elastic Constant C56all = ${C56all} ${cunits}"
Elastic Constant C56all = -0.00510861226899685 GPa

print "========================================="
=========================================
print "Average properties for a cubic crystal"
Average properties for a cubic crystal
print "========================================="
=========================================

print "Bulk Modulus = ${bulkmodulus} ${cunits}"
Bulk Modulus = 49.8436334776207 GPa
print "Shear Modulus 1 = ${shearmodulus1} ${cunits}"
Shear Modulus 1 = 28.432460964027 GPa
print "Shear Modulus 2 = ${shearmodulus2} ${cunits}"
Shear Modulus 2 = 18.4625709743278 GPa
print "Poisson Ratio = ${poissonratio}"
Poisson Ratio = 0.335149210088253
Total wall time: 13:38:30
